--                                                :Z       B.vBQ          iu  B5             BB                                             
--                                               sB      .BBMBB           .1   B.           XBM                                             
--                                             7QKD    .MBBBBB  .         :K   2B  v       BP B                                             
--                             .X            .BB :Q   PBBSrBB  .          .d    BB Bi    .QI  Br                                            
--                              BB.         .BB  BB  BBQ  BB.             :b    rBZ.P 1 :Bi   BS                .i                          
--                              EBQ.     . .BQ   B..BB   BB.  .           rD     BR vBBBP     BB                R:                          
--                              BK Qi   i..BB   rBUBi  iBQ:  .            vd     7B .d i      BB      i        BU                           
--                              BL  Bi  BrBB    JBB   7BBr                rY      Qi i    .   BBS    bv      .BB                            
--                             :B    bZPUdB.    DB   .BBP                 v:      EP r    .   BUR   BB      5BvE                            
--                             Q5     7B Mr     2.   BBB                  s       :Q r.  ..   BiM LBBB     BB  Q  .                         
--                             B.       7E     :r   LQB.            .     1        D  7   .   M.BQZ Bv   1BB  dQ 7                          
--                          7 iB        B.     .    QBP                   7  .     5  2  .   iSrB   B  .BBr   BQ1:                          
--                          rbBL       rM          :BB                   ..  :.    :  P  .   7i5B  L5 gQu    YBBB                           
--                          .BB        Q.          LBj             .     :   r:       X  .   B QQ  Bgji      BBBs                           
--                        r  QB   ..   B          .KB.             .     .   ri      .7     :B BB 7B        DQBB.       :    i.             
--                   i    Q. BQ   7P: .B         . QB             .          r:      v.     DY B. QJ       :BBBQ  .1UUBBi .vBB              
--                  .Q:   DE BP   :.: XB         7 BB             .          r:     .:     .B :Q 7B        BBBBBgQBv:BBvJqjiB:              
--                   BQ  .BB7Qv   .v  QB         7 BB            ..          I:   . u.     DB PS B7       LBBBBBj  :Db:.   gI               
--                   gBv :BQBBj   .U  QB      . :. QQ            ..          Bv    .q     7Bd B 1B    .   BBBBB  .2i      BB      .        .
--                   qDB.:JKQBE   .P  EB      . v  BP            .           Bv  . S:     BBiqi B.   s   BBBBB  :r       BB     rB:       7Q
--                   XL:BEPrPUB   .5  rBi     : v  B5           ..        .  QJ  . B  .i .BRi5 B5   B: :BRBBB:  .    .  BB:  rgPB1      YEQ.
--                   7R jBB:B uv   u  .Bq     . r  BJ           ..       i  iB7   7Q  Pv DB.B PB   BY UBijBBS       r  BBU dQB.:BY   .2XBQ  
--                    B  qB:B:     2   vB     : i  BI           :       :i  bBr   Bv .B  BE7uUB   Bg gB..BBR:      P  BBBBBB:  BBE  qK7Qg   
--                    Bv  P 7B     B.   B.    : :. uL           :       j   BBi  :B. BB dBZBgB:  MBPBB. QBBv     iD  BBBsJi   :BBXrIiuBr    
--                    .B    .Q.    ZB   Q2    r : .:v           .      vr   BBj  BB PBR:BQsBBv vBBBBB  BBBY   sivB  MBB..:   IBBB2 .BB.     
--         :bJ      JR s1    BZ    iBi  iB    Y : i:r          :      .Q   rBBP rBv QBQBBrqBP:BBBdBb  BBB:   BMsP  vBBi.:  LBBBK   BQ       
--          .PBB7    QB.qi   BB   .UrB   B:   X.: YL      .    .      Bi  iUBBU RB.PBQBQPsMgMBBQugY :BBQ    BQrL   QB5...IBQBU   :BQ        
--             gBBE2  1BBBs   BJ  :qiQu  2P   Jr. :P           .     7B  jvBBB. BBUEDBBQSSKBQBBLDQiBBB7   .BB..i. EBdiSQBBBv    UBJ    qM.  
--              .gQKMB2RBBBqX  BP rRBrgu  R   iP   B          ..     Br  BPBBQ IBB2dBQBDJIBZZBJPBBBB7    vBI  sJ gBBBBBBg.    IBB. .vrBg    
--                LDr.rPBBBBBBJ B2 dBBZBB :5  .B . B5         ..    PB  :BBBQ2iBbvPQBBBYuBPqBIjBBB.     QB:  dB5BBBBBB7     UBBB5:gP.Y2.LQZB
--                  vPr   2QBBBBPBJ:SBQBBg Mr  B . JB         .     Br  JBBBBBBsrqQBBB7IBPKBD7BE    . iBB.  SQBBBBBBi     1BBBBBSr  PM157L1.
--                    iE5    ijQBBQBJbgPgXv B  D1 . Bi         .   RB   MBBDBQivQBBBQrKBZKd7:g:  iEMrgBB7  rBBBBBB:    .bBBBDSBr    .   r7. 
--                      7BQi    ..7gBBBQquY LQ .B :.2B            .BJ  :BQZRq:qBBBBQsBBBBS.:XUrDBQBBBBBq    BBB1     :BBBM2rrBB    .  dP.   
--              r.       v.BBJ       PBBBP27 BB.BY 5.BI        .  QB  :XQQI5iBBBBBBPBB:i. 7gBBBBQBBBiggJsv: rB      DBQBQU r7Bv   i.uB:    7
--              Dv       s  YBBQi      KBBBB7 BB7B  drB.  ..  :.  BQ .PBBvYrBBBBBQBU.    .gBr:RBEiB::BBDY.   YQ.:. MBBBX  i BB   vIXv     QB
--             rb:i   .::j   Qi:QBq.    :BBBBXiBEgX .gEB   sr  7 YB. BBBUi7BBBBBqJ:        .. L:  BRBBIri7    vBi iBBBv  . iQj  vb7:.  7.BB 
--             vR.:i  .q5    gK. rBBK7.    KBBBBBQBr vdBB  7Pi g dB iBBBisBBBQE:            .i.   1BBsi:.   .. .B.7BBS    .BB  qQ.r:  BdBB  
--            r7PP ri .r7  ...Bj   7Qbsv  .Br dBBBBBDEBZQZ r2P grBL BBBjjBBB7    ..           i1.  rBBBBBBbsr7i. uBBBL    BB  BQ:2:  BQBD iB
--           7B.iB  rv.    .i sZv i :BviP  QQ   :dBBBBBdQB5.dPiYBQ.1BBBuBvQ.    :i              Bg  QBBQDP5vLi::2UPBBg   BBd Bqi2..sBBB2:ZBB
--           JQi Bj         J  2vr7r  QUKB1LQ:      .BBBXRQEQZPiRXSBBQ Dr      :7               gBB  BZIY:      .XbBBL .QBBBBrrPr5BBBBriBBQD
--           sBJ :B         5L  L1QZq :BDBB:Qs     :  rBBBQQBBBDgRBQ:         :u               sBBB   DQBBbi      DBBiJQBBBP.SBDBBBQg.:QBBB7
--           XBB  KK.       .B   7BBBPiBQBB B7     :u   .L.igBBBBK.     .    rY              .BBBBB    jQBBBPY.    rBBBBQBQ.DBBBBBBI.rdBBBSr
--  :     .i 5.g.  S7v  .    B:   KBBBBBBB..B       .5u      .S..     :.    s7             .KBBBBBB.     QBBBQ2i     MBQBBggBBBBBBv.vDBQBZ:L
--   BBqYi.BBr  r   :r5  i.  QB .  BBBBBQD B:         rgs. .         :  .  J:        .  JBBBBBBBBBB.     BLrBBBBB5.   .BBQQBBBBBQ7iBQBBBS.iB
--    BBQUPQB.  .     :K. j. .B r  7BBQBB B.            :Jr....  ..      :s           7BBBBBBBgPv.       X:  :YQBBBQBr  iDr.PBBBgrBBBBPL71BQ
--r2qbBBQr  .BB.        7: P. Qb . JBBBB  Br              .i. .. :..   :ui          rBBBBBBBEY    1u    BL.     .iRBBPRBrrQ1  .2QBBBQ52BBBBB
--B5Pj  RBR.  IBB1.      .  u  BSgBBBQBr  5Bi ....            .X:.:.. sg.         iBBbiirrP7i.     BB.  BL i    ... i: :BU :      ibBQBBBQBQ
--Q      .KZ:   :QBBg.      .BBBBBBBgBBBQd BBBQBBBBBK7.         v::1QP5         .RQg .              .B1 BY  i.   .JPi..  BQ           rDBBBB
--BBg       .      :BBBBv  BBBBBbJ: 2QiQBE  ..i2BQBBBBBBj.      iPMdBQd        sBQ. 77. .            B2iZ.i  ::.  :vBBi   gBU.            7d
--BBBB2: iKEsi        .JQBBB7      .q  JBBR       BBMBBBBBB7   rBB5rLEBBi    JBBI.....  B1         DBU Qi..7   .i  .7BBB:  igi.             
-- :EgDPPv:iUBBg2Lr:.   ZBB            .BBM     .7B:     rBBBMBQBDJY7rUBBBBBBBBi  .     Xg.      DBu   B i: Yi   i.   EBBQ1 .q              
--    rr:.::.  .iL7r:  BBB  :..  .     IBB.   .ESuZv      :YBBBB       .BBBBBX  .BBB.  i.Lr    2BB    5B  S  rLi  :i    QBBBr.I             
--      ..            EBB  :. .   .     BK   .B7ir1.         KB.           .i.    .Qg .r ..r  KBQ   . B7  .1  :vL  .r.   IBBBBPE            
--  :5U:             :BB  :.           gQ   :P:.v Qv    B  7iB             .        QB7   .ri vB    qBd    ir  .LJ   i.   vBBBBBQ           
--    :5QRI:         QBL  r       .   dB  irv  v  rBBK .B.qs X         :           vBB     .5  :   vB:      ir.  Lv   :    rg iBBR          
--.  .   .rISjr.    .BB  L.          rB .BK   : .   .BB2.g2  :                   uBBK    :  ..     qQ. .     :i.  r5r  .    rb   P.         
--YSi         ...   QBr .7        . .B iBB   . :.     sL iBR.i           .    .:BBE      s  JQ     5gB  i:    :ri  :5X       7q             
-- .Yd5i           .QB  i:        . bZ2BB   .i..    . v   SBBB.          .    .BBB       D..D.  1S:i B:  rr    :.B. rgQ     : qi            
--    .r7:.        IBP  r.        . BQgBB   g..    i  g    .rBK               QBLrqPL.   BBQ   ZBsg  5S   2i     LBPbQBB.   .QgB            
--...:.::vYvv7rrr. BBs  :..        .7 iBE  BL     Y. vb7  JYdBBr             dQ     :SEXqg.   :BQB:  .U    g.    .BBQBBBBS.  v1r:           
--    ..rY55PEQBBQQBB: .: .           X7j:BB.    Li iP .UBBB: :B1           PBII77Yr        :PBBBB  ...1   .g     BZYUKBBQBB  q             
--iLIBBBBBBBBBBBBBBBB   : .  .       .r BBBBr   .:  .Bv        BBB7       .BBBBBBBBBBBM1i5BBBBBBP.I  :..2   27    BP     IBBB7:7            
--BQBj:        7BBBBB   r .          . .B2XBr   : .  :gq. YMBBb::1BBQX2IEBB1. .1BBBZBDqQQDr BQ:BS b  :: 7.   Z    BB       IBQEY.           
--         .:rr7i.7BB.  7  .           iB gB   7: ..    .BB5BB7  1v..rKXr.       BBEr      gBr DP  . .: r: . U7   BBr       .BBQJ           
--          .i7LSuPBB:  7  .           .i Bs  :v  .     bP   BBPB:                BBqBd:BEQg  .7B.    i.r. .: P  .BgB         2BBE          
--.rv77Ij7ii..     BBv  .i                B:  :7  .    BB    .QB  .  i             B7.BBr2:    rLB    ::v   ..i:  B bZ          QBB         
--Lv7:.            PBP   v                B. .BU  .   uQ      B  .  .. ..           B .BS      7.Ei   .:Y .  :.r  BE Xv          .BBr       
--      .:iJPQQBBBBBQB   i:               B :QB: v   .B:    :B:  .  r  i            ri sB.:     isi    ig  .  ::  PB  7:           .Y.      
--..:YBBBBBBBBZKXujrBB7  .r              iS.BBB  R   BQ    .BJ   .  r  r             r  Bi r    7.v     BY i   .. iBB  ..                   
-- ..ir:..          :BB   7i             PiBBYv .B:  Br    BB   .. .i  r:            i  :B 7I   : q     JB.:BX     dBj                      
--BQ5PS7:.       :PQBBBv   Y.           .EgQ: B BBB .B:    B. . .. .:  :K             r  Bi B   ..r    uUsY:BBB.    BB                      
--IDBM7i.    .rQBBQE.iBB   ir           PBBX iBgBQB .B:   .B  :  i. :  .B             1  :K Rr   ..:   rQB .BBQBP    Bi                     
-- ::      .ivI5i     .BB   U...       :BB2  LBQr B::BI   .B. r  r: i   gr        .  .:.. g Ug    .d    BQB .5UBBBBrrud                     
--:r        ..          BS   X ..      BB.   KBL  BBSBQ   .BJ i  .5 v.  7R        .. qY7  1PIB     B.   Qg.u . r7.BBBBQB                    
--U               isMBB2DBv   S ..           QB    BBBB   7BB r   D :s   B:        . XBv i.BBB     BB.  BX      i     iQBr                  
--            .7L777r7:: 5Bi   P..:          g:     BBB   IBB..   v2 B   iE        . .BZ.r.BBB     BBB: Pq              .BJ                 
--       .. .:            DBv   2. i                iQX:  5BB..   .B JY   R.  .    :  Bg.iJMBBs    BBBB: Q                Pi                
-- .:rivr::r7qQBBBQBgXvi.  QBJ   D: i.              ..:D  v5B. :   Bv.R   iq   :   U  BD::EQQBBX   BivBBrZ                 .                
--irirrr2QBBBBBgK117::.     gBI   dr i.               rg   .BL .   vB g.   2.  r   J  BB. bBBEBBB. BX  YBBR                                 
-- ..iirr:.              ..:qBBZ   Jj ::              7j   IBB :   .BJrZ   .v  :   2 .BB  vBB. vBBsPB    LBI            Ls.                 
--         .:::       .i1QBBBgBBQ   :1  i...          Dq. BBBB  .   BB:B    7. :r  g iBB: iBBv   dBBBi     :     : :   .r:.                 
--    .iii:       ..rXqPsr::..iBBB    L: :....       .QP BBBBBq .:  .BPBi .  r :v  B JBBM  SBB     ZQP         . i .i .R:                   
--..:.           .i:.     .:vv: .BBi   :L ......     ubPBBBI BB7 :.  gBBB U. . .7  Q 2BQBR  BB      iB:        .r..ir.sK.                   
--          .:iY7ii::..         uBBBZ    vi ......   .:BB:i . BBX     BBBP g   .7  B.KBBQBBrvB:      rB.        :BvI1  :                    
--rXRPdPMBBBQ57uqP1Jr.     .YgBBBBBBBQ:   :7. . ...   BB  .J   PBB:   .BBBqPb   7  QibBBX qBQBD        .        igb.d.                      
--BBBBBBBBIivMBQq1i.     .iIPBBSr:.7IBBP    rr   ... .s  .d     BBBP.  .BBBBB.  7  BSBBB7  .ZBB.                jID. :     ..               
--    BBDMBBBYr7vi    .:YYr.     :jDQBBBB.    ii.   .   .E     BBEQBBD  :BBQBD  r .BBQBQ      Dj                ..SB.2:   .i.             .Q
--   BBBBBX7ivJv.    ..      r2BQBQBBBQBBBS    .7J.    :X    .BBd  rPBB5 :BBBB: : iBBBQU                         .rd...:::.              vQ.
--  QBvbB  :sri         iUBBBQBBBBBQBQQQBBBBi    .vLi :1    .BBI... .::BB.BBBBB   sBBBK .J.                      ..:r           .       DB  
-- ..  BU :1r     .i7UXZSr.:LE5rSBRBQBQQQBBBBBL     .7r    .BBi.:i:i.:  7BBjXBQi  SBQBB:  vK:   ..                :ir          .       BB   
--    jQ:ir   ..:r7:.     KQr  7BBQQQQQQQQQBBBBBd.         BB   vr. .... .BM BBM  BBB:IBB   bg:   ..              :51.       ..      :BP    
--    QB.             .:QBY   QBBBQQQQQQQBQBBBBBBBQD:     BBBr   vs   ... IB KBB iBBr  rBBq  .ZQ:   ..            .: ..    ..       qB7    7
--   2B          .iuBQBBB  :7BBQBQQQBQBQBBBBBRBQBBBBBBQ: dBBQBB   iS:     iB::BI BBZ    .XBBi  .BQ:   ...                 ..       BB.    iB
--   B.     :2BBBBBBBBBQ  RgBBQBQQRQBQBBBB.DBQQQQBBBQ.YBBBB iBQB7   UU     B .BMQBB     .::BBB   iBB.   ...              .       rBB     5BB
--  Q2  .IBQBQBBBBL BBD :QBBBQQQQQQQBQBBD  BBQBQBBB.     .   rRQBB   idi   .  BQBB.       i:vBBs   iBM.   ...  .  .    ..  .    dBI    .BBBB
-- 1B jBBBBBBBMr    BB.7BBBQQQQQQBQBBBQ.   BBBQBBZ            .jBBQj   KP.    BBQ.         :7:SBBi   vBR     ..  .   ... ..    BB:    jBBBBi
--vBBBBBBBBX:       QBQBBBBQQQBQBBBBQ:    vBBBBB1                rBBB.  .dS  .BB             rr:RQB.   jB5      .   ..  .    7BQ    .BBBBI. 
--QBgbJ7i           SBBBQBBQQBBBBBb.      7  BBX              .    jBBQ   :R7rr               :J:iBBQ    IB7           .    QBi    XBBBB:.  
--                  rBBZ QBBBBBBQ.           BB                 .    uBBD   Lq.             .   vJ:LBBP    jZ:      ..    :BB    :BBBQQ...  
--                  .BQ  rBBRBBr             5.                   ..   PBB5   UP.            ..  :jv:dBBU    12:         EB7    bBBBBb:i.   
--                   B.   BBBB.                                     .    dBBS   PK.       . . ...  iUrrBBQY    vv.     .Bd    rBBBBRrii     
--                   .    YBBr                                             ZBBv  .dI         .   .   LUivBBBi    ir   1g.   .BBBBBP7r.      
--                         QB                                            .. .RBBi  :Ev    .   ..... . .1Y:SBBB:    ::r:    SBBBBBPP7        
--                         PP                                              ::.rBBB.  rP7   . . . .   .  :IviEBBB.        7BBBBBggP          
--                          .                                                .7ivBBD   LKr. ..... .....   rIriBBBM.    :BBBBBQZDr           
--                                                                              ..:dBB   :7:   ..    .      i7.:gBBQ.vBBQBQQdui             
--
--                                                                                                     .Y..                                 
--                                                                                 .:vXgdBBQKgs.     XQq.i:vJ                               
--                                                                          ..KRBBBBBBBBBEX1BBBD1.:1BBP:7:7YQ2X.                            
--                                                                    iY7BBBQBQBBBBBdr     5QL..rBQBB   7Md1QgQ:                            
--                                                                 YgBBQBQBQBQBBu::         K    UBBR   7UPQB.B:                            
--                                                           rYRQBQBQBMBQBBBi77.            M    PBBQ   . iBL77.                            
--                                                      .iMBBQQQBQBQBQBQQgi       i:.       BuJSBBBBB  ... .i .r                            
--                                                :bv:rZQBQBQBgBQBPBQE:         qBQBQB:.iUuU.7iSr7QqrrKBBBQKvJ5ggB                          
--                                      .:. .vZQBQBBBRBQBQqiBQBQr.      rIqY:  Sq.XBBQDPI:  .ui  .r PQBBBQBBBQBQQ:                          
--                               .::.rPJqdgdEBQBQBZBPgBBQBQBRP:      rYUQBBBQB:Q:.:jr.     .dU   P  :siIBBBBQBQLB.                          
--                      .     .KSIBQMQJBgsiUBBQDBMQdDQBQBQQs.       :q    IBBgKii:JL       ig   2v :U5: .QBgB2gEBB.                         
--                   rBBQgI7riULiQK7MZ7BQS7BMBZQRBQBQBQZ:    :LdQBBQR  :77ri..   :d        75   E  s7I   i jIB.BIBD                         
--            7:IJu5BQB7iUgXIiJrgLsRrvBddMBBBQBQBQBPY.      Qi  vQBQBiuuY:.      P5       .vI   Z  i71  g   uQiZvQB                         
--       . ..QZdSiIBEP1rr1Mq.1vYYdq.rD52dP5BQ5YSir         P.  :7dji.:.          d7        7s   Q  YIJ .B   iB:ELBQ                         
--      rrJK1s7uJj571IQE vBviQ:UMvB.UQBBB2d.         .::7r:R2YqYZ                U7        iY   Dr .1iDPBQi.2B BYQB                         
--    .B sq::7.Yi5 ..IBBvvQgdb5PDggBQDbLiX     ..IRIrPPMbPqP:  j.                Su ::irr1Y:U    B  i17vMBQBB.2BqBP                         
--    QdJgv.:.rr17 5i7Q2B:sIDr7E.Ysru7r:    .jRRP:.idZr.  U   :K          i..:vr1SB:17I7KuugQL   .QiQ1i:ii:rvqBuBQ                          
--    QSgQqi::77YQ.L:Ug:.QSMggEXrIUr..  .L2QQB7: iqj     2.   v:   .::vviqQUJJ5uIvd5:vXPbgXv5B:   .IKXRP7EQBBBIZQQrEX                       
--    .rirKZKJB:KgErrLQBEPj1dPQPJ.:    U:  L5   Lq.      P    Ld7S7JjSP2qPEXUvri7JsKEQBb.E.s::B.    :2QBBQBQYiMQBQBQi                       
--   vr.j1Ud.rQuu5EBJJ25DB7:          QY.irU.JQ q:     ::s:YvPYQPduSrr727vs1KPEBQBQBQi7v : vBr:BX   .u:LgBEREBQBBBQB                        
--    iijDU  .X1BrU2PIRUi       . ..:.BUQ.B :gBiS...7rYsR7Z7MBjrIIgZgdQRQQBggqBQBQBQ:  1   :BQE BQv     7qZvbMBBRXBZr:                      
--        .     .i        .UQBQBZQurrBQ K Qi YQjQKZDEDEUQBQgvviBQBBQ7BQBBBQBQBQPJL:. UBBM1srBBQB LBBPu:i:77UQBuBBi:Qd                       
--                     :PQBQ.IP      YB E Ki:iBiKSBBBRBddvX: 71Qu7B LQMdBDQQBr:     YrX.vbBQjQBBB::QBQBQBQBQi rBBQ2iBQ.                     
--                 :SQQQL5i. r   .:ii uii:.UsSQBQM:  :       .QB EQ QB     UBr      B : rBQu5BQBBBX..  .BBQB .QBQBQd:Bq                     
--             .vvBsb7irq.  BvrYJv7:7..D   Pj QQBr  .J7qEDBdr rQ.L. s   iZr BQ      P.7  1BuBQBBBQBQK7  BBBQ  BBBQBQBDSv..LYi               
--          :uJriJrr:Y iQ  .dr..    .v Dr. :2 .L.JPBBBQPLgQBBBiUr:.i:rQY:BQ BB       BQ:  LBLXqKSXvIK ..1Li::dQBQBBQ.iJMB: :B               
--      v5J7Bqrq7Q25SQ7 B.  Prv:irir:i IBBBvi:i  .BQBg.iQBBZBMBgBIBQBQP: gv BQ     .ruZXs..                iBQBBBQB2  rvJis.BLriii.         
-- r7qdUQBYXP2QB qvr::  Q:  UK. .. .i7 r:gQ17S. :7BBQ riILrs::   .rBBBY  gd QB     .DdZbvgDBQ. rKBBUMQZBgb1QQi.v2  ..j7K:iv7:vrriPBE        
-- Ri7Y2 RS .:   u:     Q:  j:. .   .  ir7BPiQ.XY1r:. i:   7s .:   UuUi  QB:7B.     7vqv 1BQBQBBqLXQi    7i       .ri   EL        BQ        
-- Qr7ur:7r:7i.7:gR7sXBQ1BEPg:v2.:ZL.:I  B: ruB..  :        ...7. :BBBQ .Q   B      vL  :BBBQBQB:  P     gg ZYE   :i 1Q7  SPE7vv.:QU        
--:MQSBEgQuKZ7BQBqIS77BQK7vQB vIRYgBBB51grE. .7 B i:v         :r.i:vS.i.:.:r:Qi     ri.  gBBBQBB:  7     .Kii.:  i qBKd Y iQrPBQ.           
--budQiibU7777.ir7iqIqYbQ7iJX2 vJqM.Q7 RXSI: 1Q 7 :.5         gr     :75117s: YBb7v1J:ii.B 7QBBBQBBBQBBB     : i . BB d1L :i .BP            
--PSvZ55BJBRQiMbsI.v57vv:r2Ssqd5rUDiQ77BBBQQYBBZBE:...  r...  L r        :..: 5EBgBQRBgi j  YQQQBQBQBBBvQQ2..sB5Q2K.:i.qBQDQB:              
-- .  .775sK7gQZP12PusE2.L.QvrsPKviiru7XLLrLX2LdZQBdv. :.. .            .:   :Qv.BQBBQ.SQg5BBBQZQQQRDB  BBi  L2Qid:K L.::uBBQBQY            
--          1Kr:7vLDZ7PI1XuRY 7ivgX7sBrviiSbr...:.BKI:ru. . 7   .i   .. i:. rDBQ YQi   QBBBZMQP BZi:BQ  BQ.  Q QdiR.b:7.B7.UBQBQs           
--                 r vM7rrSErJvuSbIBYKPr:rbiY1Js.g7Prs2Y. ..7rr2i.::i::.r7:.iBQBq... vQBgBQBgQQ DB.Pr  7QBJ7rgs Qb7B.M2ui:d  BgB:           
--                   :.irIP.1Quqi7v5:XDP5 BvB7iQDBiBUZvQjSX1..  17Y.:vBdL:r:::.irirsdQqSBQBBBgBQ.r:   iQBQi7Lri  . .           Pv..         
--                     : iB.su.D:: K.M Yq.UiQJ.rrr.D.5rrQKbBQY:1jIQSrLvY   iv1YQDQbii:... .. .:v7..JJBQBQQ SuKXRdXqdgBDQZQUdDg5BSuJSIXIUrvJ:
--                        .  i :iP5 Bur7E:jiUbr7gXdiiri7di.gPjQvg1:SIQBQEXBQsPPIIL.   :r2rvPP7vv5PqXSi:::.SZQQBQBQBBBQBQBQBQBQBq5BBBBQBBBs  
--                                : . .i:D r.7:QYiS.ibIvBiYdrBURii7siKBrjb2B.SBZPUPdsRBjBEvBQQQs..   ri7vKv7.::.:i::.::i:vv1:L1dQBBgL:iqZ57 
--                                        i  7 : .B2:1bLsrr:Pj Z:X5:v i5udQ:.gBr7JIgBQ.v7XJIiDXU. J1KSBBM1BQqBBMD:777v5i:i:.i:ir7rr.        
--                                                 ...i Yu  Pii1gv2u7ZP:QUBiPBMXZ.PBY5KggSiSiJiBQBXrSrqB5X.LRPur.:.77EMBQBQBBBZKi:r:        
--                                                          :.     i: u.vi:LJi.r:7.i: :IS:SrB:J..Bi IQ.d:5UrBBr7BQBgB7jr2vB:2:              
--                                                                                                    .  v   :. . .                          
----New series of simple scripts that just work..nothing fancy 
                                      


if myHero.charName ~= "Trundle" then return end
require "DamageLib"
local castSpell = {state = 0, tick = GetTickCount(), casting = GetTickCount() - 1000, mouse = mousePos}
local barHeight = 8
local barWidth = 103
local barXOffset = 0
local barYOffset = 0
function SetMovement(bool)
	if _G.EOWLoaded then
		EOW:SetMovements(bool)
		EOW:SetAttacks(bool)
	elseif _G.SDK then
		_G.SDK.Orbwalker:SetMovement(bool)
		_G.SDK.Orbwalker:SetAttack(bool)
	else
		GOS.BlockMovement = not bool
		GOS.BlockAttack = not bool
	end
	if bool then
		castSpell.state = 0
	end
end

class "Trundle"
local Scriptname,Version,Author,LVersion = "TrundleExpress","v1.0","Tocsin","7.17"

function CurrentTarget(range)
	if _G.SDK then
		return _G.SDK.TargetSelector:GetTarget(range, _G.SDK.DAMAGE_TYPE_PHYSICAL);
	elseif _G.EOW then
		return _G.EOW:GetTarget(range)
	else
		return _G.GOS:GetTarget(range,"AD")
	end
end

function Trundle:__init()
	
	self:LoadSpells()
	self:LoadMenu()
	Callback.Add("Tick", function() self:Tick() end)
	Callback.Add("Draw", function() self:Draw() end)
	local orbwalkername = ""
	if _G.SDK then
		orbwalkername = "IC'S orbwalker"		
	elseif _G.EOW then
		orbwalkername = "EOW"	
	elseif _G.GOS then
		orbwalkername = "Noddy orbwalker"
	else
		orbwalkername = "Orbwalker not found"
	end
	PrintChat(Scriptname.." "..Version.." - Loaded...."..orbwalkername)
end

function Trundle:LoadSpells()
	Q = { range = myHero:GetSpellData(_Q).range, delay = myHero:GetSpellData(_Q).delay, speed = myHero:GetSpellData(_Q).speed, width = myHero:GetSpellData(_Q).width }
	W = { range = myHero:GetSpellData(_W).range, delay = myHero:GetSpellData(_W).delay, speed = myHero:GetSpellData(_W).speed, width = myHero:GetSpellData(_W).width }
	E = { range = myHero:GetSpellData(_E).range, delay = myHero:GetSpellData(_E).delay, speed = myHero:GetSpellData(_E).speed, width = myHero:GetSpellData(_E).width }
	R = { range = myHero:GetSpellData(_R).range, delay = myHero:GetSpellData(_R).delay, speed = myHero:GetSpellData(_R).speed, width = myHero:GetSpellData(_R).width }

end

function Trundle:LoadMenu()
	self.Menu = MenuElement({type = MENU, id = "TrundleExpress", name = Scriptname})
	self.Menu:MenuElement({id = "ComboMode", name = "Combo", type = MENU})
	self.Menu.ComboMode:MenuElement({id = "UseQ", name = "Q: Chomp", value = true})
	self.Menu.ComboMode:MenuElement({id = "UseW", name = "W: Frozen Domain", value = true})
    self.Menu.ComboMode:MenuElement({id = "UseE", name = "E: Pillar of Ice", value = true})
	self.Menu.ComboMode:MenuElement({id = "UseR", name = "R: Subjugate", value = true})
	self.Menu.ComboMode:MenuElement({id = "comboActive", name = "Combo key", key = string.byte(" ")})
	self.Menu.ComboMode:MenuElement({id = "DrawDamage", name = "Draw damage on HPbar", value = true})
		
	self.Menu:MenuElement({id = "HarassMode", name = "Harass", type = MENU})
	self.Menu.HarassMode:MenuElement({id = "UseQ", name = "Q: Chomp", value = true})
	self.Menu.HarassMode:MenuElement({id = "harassActive", name = "Harass key", key = string.byte("C")})

	self.Menu:MenuElement({id = "ClearMode", name = "Clear", type = MENU})
	self.Menu.ClearMode:MenuElement({id = "UseQ", name = "Q: Chomp", value = true})
	self.Menu.ClearMode:MenuElement({id = "UseW", name = "W: Frozen Domain", value = true})
	self.Menu.ClearMode:MenuElement({id = "clearActive", name = "Clear key", key = string.byte("V")})

	self.Menu:MenuElement({id = "CustomSpellCast", name = "Use custom spellcast", tooltip = "Can fix some casting problems with wrong directions and so", value = true})
	self.Menu:MenuElement({id = "delay", name = "Custom spellcast delay", value = 100, min = 0, max = 200, step = 5,tooltip = "increase this one if spells is going completely wrong direction", identifier = ""})
	
	self.Menu:MenuElement({id = "blank", type = SPACE , name = ""})
	self.Menu:MenuElement({id = "blank", type = SPACE , name = "Script Ver: "..Version.. " - LoL Ver: "..LVersion.. ""})
	self.Menu:MenuElement({id = "blank", type = SPACE , name = "by "..Author.. ""})
end

function IsRecalling()
	for K, Buff in pairs(GetBuffs(myHero)) do
		if Buff.name == "recall" and Buff.duration > 0 then
			return true
		end
	end
	return false
end

function ValidTarget(target, range)
	range = range and range or math.huge
	return target ~= nil and target.valid and target.visible and not target.dead and target.distance <= range
end

function Trundle:Tick()
    if myHero.dead or Game.IsChatOpen() == true or IsRecalling() == true then return end
	if self.Menu.HarassMode.harassActive:Value() then
		self:Harass()
	end
	if self.Menu.ComboMode.comboActive:Value() then
		self:Combo()
	end
	if self.Menu.ClearMode.clearActive:Value() then
		self:Jungle()
	end

end

function Trundle:HasBuff(unit, buffname)
	for i = 0, unit.buffCount do
		local buff = unit:GetBuff(i)
		if buff.name == buffname and buff.count > 0 then 
			return true
		end
	end
	return false
end

function Trundle:IsReady(spell)
	return Game.CanUseSpell(spell) == 0
end

function Trundle:CheckMana(spellSlot)
	return myHero:GetSpellData(spellSlot).mana < myHero.mana
end

function Trundle:CanCast(spellSlot)
	return self:IsReady(spellSlot) and self:CheckMana(spellSlot)
end

function EnableMovement()
	SetMovement(true)
end

function ReturnCursor(pos)
	Control.SetCursorPos(pos)
	DelayAction(EnableMovement,0.1)
end

function LeftClick(pos)
	Control.mouse_event(MOUSEEVENTF_LEFTDOWN)
	Control.mouse_event(MOUSEEVENTF_LEFTUP)
	DelayAction(ReturnCursor,0.05,{pos})
end
function Trundle:Draw()
    if self:CanCast(_E) then Draw.Circle(myHero.pos, 980, 3,  Draw.Color(255, 000, 222, 255)) end
	if self.Menu.ComboMode.DrawDamage:Value() then
		for i, hero in pairs(self:GetEnemyHeroes()) do
			local barPos = hero.hpBar
			if not hero.dead and hero.pos2D.onScreen and barPos.onScreen and hero.visible then
				local QDamage = (self:CanCast(_Q) and getdmg("Q",hero,myHero) or 0)
				local WDamage = (self:CanCast(_W) and getdmg("W",hero,myHero) or 0)
				local EDamage = (self:CanCast(_E) and getdmg("E",hero,myHero) or 0)
				local damage = QDamage + WDamage + EDamage
				if damage > hero.health then
					Draw.Text("killable", 24, hero.pos2D.x, hero.pos2D.y,Draw.Color(0xFF00FF00))
					
				else
					local percentHealthAfterDamage = math.max(0, hero.health - damage) / hero.maxHealth
					local xPosEnd = barPos.x + barXOffset + barWidth * hero.health/hero.maxHealth
					local xPosStart = barPos.x + barXOffset + percentHealthAfterDamage * 100
					Draw.Line(xPosStart, barPos.y + barYOffset, xPosEnd, barPos.y + barYOffset, 10, Draw.Color(0xFF00FF00))
				end
			end
		end	
	end
end

function Trundle:CastSpell(spell,pos)
	local customcast = self.Menu.CustomSpellCast:Value()
	if not customcast then
		Control.CastSpell(spell, pos)
		return
	else
		local delay = self.Menu.delay:Value()
		local ticker = GetTickCount()
		if castSpell.state == 0 and ticker > castSpell.casting then
			castSpell.state = 1
			castSpell.mouse = mousePos
			castSpell.tick = ticker
			if ticker - castSpell.tick < Game.Latency() then
				SetMovement(false)
				Control.SetCursorPos(pos)
				Control.KeyDown(spell)
				Control.KeyUp(spell)
				DelayAction(LeftClick,delay/1000,{castSpell.mouse})
				castSpell.casting = ticker + 500
			end
		end
	end
end

function Trundle:Combo()
	if self:CanCast(_Q) then 
		local QTarget = CurrentTarget(175)
		if self.Menu.ComboMode.UseQ:Value() and QTarget and myHero.attackData.state == STATE_WINDDOWN then
            if ValidTarget(QTarget, 175) then
				Control.CastSpell(HK_Q)
                Control.Attack(QTarget)
            end
		end
	end

	if self:CanCast(_E) then 
		local ETarget = CurrentTarget(E.Range)
		if self.Menu.ComboMode.UseE:Value() and ETarget then
			if ValidTarget(ETarget, 980) and myHero.pos:DistanceTo(ETarget.pos) > 200 then
                local block = Vector(myHero.pos) + Vector(Vector(ETarget.pos) - Vector(myHero.pos)):Normalized() * (myHero.pos:DistanceTo(ETarget.pos) + 92)
				castPos = ETarget:GetPrediction(E.Speed,E.Delay)
				self:CastSpell(HK_E, block)
			end
		end
	end

    if self:CanCast(_W) then 
        local WTarget = CurrentTarget(W.Range)
		if self.Menu.ComboMode.UseW:Value() and ValidTarget(WTarget, 900) and not self:CanCast(_Q) then
			castPos = WTarget:GetPrediction(W.Speed,W.Delay)
			self:CastSpell(HK_W, castPos)
		end
	end

    if self:CanCast(_R) then 
        local RTarget = CurrentTarget(680)
        if self.Menu.ComboMode.UseR:Value() and RTarget and myHero.health/myHero.maxHealth < .60 and ValidTarget(RTarget, 680) then
			Control.CastSpell(HK_R, RTarget )
        end
    end

end

function Trundle:GetEnemyHeroes()
	self.EnemyHeroes = {}
	for i = 1, Game.HeroCount() do
		local Hero = Game.Hero(i)
		if Hero.isEnemy then
			table.insert(self.EnemyHeroes, Hero)
		end
	end
	return self.EnemyHeroes
end

function Trundle:EnemyInRange(range)
	local count = 0
	for i, target in ipairs(self:GetEnemyHeroes()) do
		if target.pos:DistanceTo(myHero.pos) < range then 
			count = count + 1
		end
	end
	return count
end

function Trundle:Harass()
    if self:CanCast(_Q) then 
		local QTarget = CurrentTarget(175)
		if self.Menu.HarassMode.UseQ:Value() and QTarget and myHero.attackData.state == STATE_WINDDOWN then
            if ValidTarget(QTarget, 175) then
				Control.CastSpell(HK_Q)
                Control.Attack(QTarget)
            end
		end
	end

	if self:CanCast(_E) then 
		local ETarget = CurrentTarget(E.Range)
		if self.Menu.HarassMode.UseE:Value() and ETarget then
			if ValidTarget(ETarget, 980) and myHero.pos:DistanceTo(ETarget.pos) > 200 then
                local block = Vector(myHero.pos) + Vector(Vector(ETarget.pos) - Vector(myHero.pos)):Normalized() * (myHero.pos:DistanceTo(ETarget.pos) + 100)
				castPos = ETarget:GetPrediction(E.Speed,E.Delay)
				self:CastSpell(HK_E, block)
			end
		end
	end

    if self:CanCast(_W) then 
        local WTarget = CurrentTarget(W.Range)
		if self.Menu.HarassMode.UseW:Value() and ValidTarget(WTarget, 900) and not self:CanCast(_Q) then
			castPos = WTarget:GetPrediction(W.Speed,W.Delay)
			self:CastSpell(HK_W, castPos)
		end
	end
	
end

function Trundle:Jungle()
	for i = 1, Game.MinionCount() do
	local minion = Game.Minion(i)
    if minion and minion.team == 300 or minion.team ~= myHero.team then
		if self:CanCast(_Q) then 
		    if self.Menu.ClearMode.UseQ:Value() and minion and myHero.attackData.state == STATE_WINDDOWN then
                if ValidTarget(minion, 175) then
				    Control.CastSpell(HK_Q)
                    Control.Attack(minion)
                end
            end
		end
        if self:CanCast(_W) then 
		    if self.Menu.ClearMode.UseW:Value() and ValidTarget(minion, 900) and not self:CanCast(_Q) then
			    castPos = minion:GetPrediction(W.Speed,W.Delay)
			    self:CastSpell(HK_W, castPos)
		    end
	    end
	end
	end
end

function OnLoad()
	Trundle()
end