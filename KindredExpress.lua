--b#MbMbMbM8M8M8M8M8M8M8MbM8M8MbMbM8MbM8M8Mb88Mb8b8#b#bb8#b#b#8#b#8d8#b#b#b#bd8db#b#MM@bMbMbM88#Mb8#8#b#8bM#8bM8M8Mb8bMbbD
--bbb8#8bMb8bMb8b8b8bMbMb8#8#8#8b8b8#Mb8b8#8#b#bd##bd#Dd0dDdh#D#h#h#dbhdhdhd0dhdhDhdh#db#8#bd#dbD#D#d#d#d#db#b#8b8#M#Mb8##
--M#M8M8MbMbM8M8MbM8M88bM8M8Mb8b8bM#Mb8#8#8dbdb#bXD8#hd0D0Dhdh#h#D#D#Ddh#h#DDhdD#hd0DhdD#d#d#d#d#d#DbD#db#b#8#Mb8bM8M8MbMb
--M8bM8M8MbM8M8M8Mb8bMbMbMbMbMb8#8bbd8##d###h#hdd2sGhd0h90P99h0h0D9h0d0D0D0DhD0d0D0DhD9D0D0dD#h#DdDdd#d#D#Db#b#b#M8M8MbMb8
--M8MbMbM8MbMbM8M8M8M88bMb8#8#8dbd#D#d#ddDdhd0DDD5lT5F90d00P9P9P9P9P09090P0900D9h0h9D9h9h9D9DhDDdh#hdD#h#D#Db#8#8bMbMbMbM#
--8M8M8MbMbM8M8Mb8bMb8#8#8#bd#ddDdD#hD0d0D0hPh9#X1l1sss5CEPh9hE9E9P0P9P9E09999P0909h909D000h0h9D0dhdhdhdD#h#Dbd8#M#M8M8Mb8
--MbMbMbMbM8MbMb8b8#8#8dbD#d#h#hd0Dhh0h9090P99dE5sls1sscsT15UEh99GPEh90P0E9E9P9P9P099Ph90P0P09h0D9DhdhdhDhdh#db#bbMbMbM8M#
--M88MbMbMbM#M#8b8dbd#Ddddh#hdhd9h9099P0P0Ph9DX1T1SGGPZOTssscl1ZG9U52GED9d9h99P0P9P0P9P9P0P09h90Ph9h0d0Dhdhdh#db#8b88MbMbM
--@bM8M8M8M#8#8#8##D#DdDd0D0h0h90P999E0E09D0PClllFdUS1O905sslsTvXEPscTl1S2GG99D0h90E0E9P0P9P0P0P0P09hhD0dhDD#hdd##8#MbMbM8
--M88MbM#8bM#8db##h#hD0D0D0090P0P9E9E9909PUCsls1TUElvsclEh5sssYTU0UlslTscTcss11FOEG9E0E9P9P9P9P999P09hhD0D0dhdD#dbb8bMbMbM
--M#M88#8bM#8#bd#D#Dd0h0h90P0P9909090EGF5lTclllllT511ssY5PGcTv1X0Osclslslclvss51C2ZP0P9E9E9E9P9E9P0PhP00hhDhdhdh#D8#MbM8Mb
--8Mb8b8#8#bd#d#Dd0D0h9h909D0D9hEGFS1lcccsslslslslcsTsY1FGXlTFGE5cYTvccsT5SUZPP9P0E0Ph0h0h99E9E0E9P990909DhD0dhdD#db#8bMb8
--Md8#M#b#bdbDdhDhD00P0909PZX2CllTTvscsTlslllslTsccYTlFUZOUFXXX25lll1lS2ZXZOFSS55551C5FOGGhhD90P9P9E990909D0dhdh#D##8#MbMb
--8bb8#8#bdbd#Dd0D0099ZF5lvcYvYcvTcsssslslTlTTvccllSFGUXOUOU2OFUOZXGXEXGOCllslcsslTsclTssllSO90d99P0P9P09h9h0DhdhdD#d8#88M
--Mdb#8d8#bDdDD0DP0P090GEXZFFCS15l1lY777vl5lSSOUGZPGEUZUXUXOUFXFFFOFU2FSC5l77;;;YT1lll1l5llsslCXDhhP9E0P9P9P90h0DDddbd8bM#
--#b#8db##ddD#hh9090EPG9E9P9PPGZO25vl#DF77T55S55l5slsls1l1l55SS22O2FCC1lY7::,;Y;,7clsll11515l5sl5G0DP9P9P990Ph9Dhdh#d##8bb
--8#b#8#bD#hD0h0090P9GPGEZGZGZGOF5T;M@@@@5;;TcTYY777777777YYcT15FCC5Slc;:,7;77Gs,:Ysllll1l111l51ls29D99P9E990P00Dh#D#d##8#
--###b#bd#D#0h0099P9GEGEZEGPGZC1Ts7.7@dP0@hT;7vsccvTc1l5S2CF2FC25S5SsY;;;Yc77;l5;:7lllcssll5111515s5EdP9E9E9P0909Dhdh#D8bb
--bD##bd#h#0D0h90P9EPGPE0EZC1cTcssl; @@E520bE7;7552SFCFCFSCSC5S5555s7;7YY77;;.cvY;YsSCSssTls1l5l5l5slGd9PE9E9P0P00dhdD#db#
--d#dbd#D#DDhD90PPGPE9PEC1cTcsTsTllc v@@9sl2OhO7;7lCSC5C5S5S5S55sY7;:7lY7;;:..77Y7Y15FUX5Tcslll5lS15l5EDP9E0P09h9h9DD#Dbd8
--8D#D#Ddhd0h0hEPE99hXCssclslssTsvls; @@@#lYSFPDU7;7l1SSC5S5l7;,,:YcYYl7;,;.  777;YlSS2OEF5vlsll1l555lS9hP9G9P9P00D0#hdD#d
--ddd#D#DdhD00P9E90P5lTlllllslvcY15Sc 2@M@@5YO2U9MF;.;7Y77;;,,77l7YY7;:;,,,:  ;sY;7l52SFFZZFTsTll51515sO99P9E9P0Ph9Dhddb#d
--bhbD#DdhD0hP0E0POsls1llllssYT1OF251:7@@M@@XTZOX9@@l     ...7#@@7 ,:,.7,..,. .X5,;71SC5F2UGZlssll5l55ll999E9P9P0PD0dD#d#d
--ddD#D#hd0h909DZScll1lll1ssv5FZFOSC17:@@MM@@P50GG#@@Mc28@@@@:7@@G  ,. :7  .,  YZ .;7CC2C22XZE1Tlll5151sCDP9E9P9990DhdD#d#
--bh#D#h#hh909dZ1s1l5l1l1TTTFZXFOSC55Y,X@8MM@@dZ#0h8@@@@@@@@M  X@@S  7. ;;  : . X;   ;lUOCF2UZP1ssll5l5l5P9E9E9P99D0dD#DbD
--d#D#DdhD009dUls1l5l1l1sclZXUFO22SS5l;7@@8Mb8MMD8#MMMMMM@M@:  :M88h: T  ,. .:  ,@:    7OZ2OFXZPlss1l5l1sG9PG9P0P09D0#D#d#
--bh#D#DD0hPdGls5l1l1llsT1EXOFFFOSS5517.8@MM@bM88b@bM#bdbM8@E   5@d9MlCl  ,  .   7@7     YXFXUGGElslll5ls2hGPG9E09h9DDdhbD
--d#d#h#hh9D95l5l5l1l1ls1EXU2F2O2255557.T@MMMMMMM@#b8hh0b8EM@2  .O29X0U0c  .  .   ;@s     ;15FUEEUsll1l1TSPEZEP9P90Dhdh#d#
--#D#ddhd0hhOs515l5l1lllGXUFFFU2FCC55c7 :@@M@M8#@#Dh8PhZ@PGD@U .   O9CC5Es    7    ;@2  .   ;7lSUZSl5l1ls19ZGZPE9Ph0Dh#D#h
--#dd#Dd0h00lllSl5l1slsZZUFUFUFOCC51cY;.X@MM@8P#bhGdD9OGM0h@@@;;   .2Cs1sSc   ;.  . Y@X; .;   ,;7ll15Sllc5ZEXEGPE90hhdDDhd
--bh#d#hDhDZllS15l1llcOEZUXOXOU22S5Tv;;8@M#M@GOh9ZXDdUCM@ZT77cPUT   :l77vYl;  ,.  . ,M@G5. ::     ,,:71lllEZZXEE9P09dhdDd0
--##dbDd0hDUl515l5l1T5GGUXUUUUF25Csc7;D@@#9@hFlDGO28##E2:      .cS   T7;;;7Y   . . .,5@bFU7. .    .:..Ylv5EZXGZPP9PDDdDdDd
--8d#D#DD0D2l15l5l1ssUPUZXUOUC25S1T7:2@@@EP#PF509C2@@l,   :Y2#Pv O;  v7:;;;7.  ..   :lX#D5S5v;;,,:;7S0#5c5PXGUEG9PDhdDDhdh
--##d#DdhDhXs5l5l1ls1PXZUZOUCC551s7,Y@@MDEEdXG5E0O2@:    1@@M5TM9S.  s777;:s,  . . ,;SYFM@D2sscTTSZ8@@#5Y2ZGUGGP9d9UZ#hdDD
--bh#D#hD9hZll5l5llcXEGXZOOCC55lc;.;@@MdGGPEGOZXdZ95    7@@7.;9M@7  77777,7v. . . .;7v7CM1O@MP0h#M@@#CTYsUGUGX99DZl1DDd0D0
--#dD#DDhh9h5ll5l1s5ZPXXUOCS51T7;.7@@9PZUEGGZOXEEh9S    7@8:.lb1, .7777;:7v:     .777;YUdv 75ZEh99Ul7Ycc1EXGXE00SsT9d#DDhD
--8hdhdhh900Gsl11lsS9ZZUU2C11c7,:S@@hhb8@@@@@#0EXGhD,    lM;;;;,:;7;;;;;7c,     .TY;;;C1#O:YTcTcTslYsslcOGGXP9UlsTU##hDhd0
--##D#Dd09EDh2Tll1sXEGUXF255c7:T@@MbM@M@MMM@@@@M92EhG.    :lY;;7;;;;777;;:     ;d1.;7cs5MC;1SS522U5sslT5ZEXPZSTlsSh#hDDdDh
--#D#D#hdPFEd9STlTlGPXGUXCSlY;h@@@@MMbM8M#bd#b@M@#PGPM7     cOs,,777;, .;.:   :@G.,7v;YUMv75O2FFXZ5TllsOPZ9UlclllX#0Dhdh#h
--##d#DdDD559d9CTslEGZXXFF5l7;d@@@M@MbDbbMD##bh#b@@bFG@P7    :E  7    ;7     ;@S  77:;1P87v2CUFXXZTllT1PE92sT11lS#0h0dhdhh
--8db##h#DUYSEbhFY1ZEUZUUCC1c:7@@MM#@8bPPhbhDP90D0bM@XPM@E;   S;;    ;:    .5D; .7;:;7Fdd71COFUUECsslsZ99Sss5l1l9hhhDhdh#h
--b#d#D#hbXls12DDXCEZGZZUUS5l7,9@@M8DDDb0GZ0ZlXF7XPhM@hGD@M7  57    ,  ., ;PFc: . .7;5P@lY5OFUOZX5vscF995ss5l5sFhh0DhD0dhD
--8dbDdDd#Pl5lslX00GEUGZZOO5Ss7;@@@Mb00G909O577..Gs29#@0GdD9. Y   .   ::.;M;v@@b  ;;l9@97lC2OOXZXTlvS90Sss5l5l1Gd0DhDhdhd0
--#bdbD#h#0Sl511s5G0ZGXGXXFF55l77@@@88#DGEZU1;. ,S.7FD8@h9ED: 7;    .;; :;  F11@; ,sX8dYvSSOOXUESTv1PhSsl1l5515DDh0dhdhdhd
--b#b#bDdDbSl1S1lTlX9ZGUGXZFOSSl77#@@8Mbdh92FCv7;5;TXG@8@DPEY s.   ,;: .7   U7dh: 7s0MT755FOUFZZ5YlZDUls1l555lUDD0DhdhDhD0
--##dbDdh#dFl5l5llvlZEZZXGUGOU2C5c7C@@@Mdh99UGGU7G2EE9D@#@dZ1.7   ,;., 7G7::M@P7 :TD@575SFFUOZXZvsX0E5T1l55511Udhd0hhdhdhD
--bd#d#h#D#Oll5l1lsYCGGXGXZUZUUFFSl77G@@@M8@#1PXSGD90b##@#@G28Y  ,;.;: ;@M2F@1;,7XMbT755FFXUXUPSsU9PUcl151555lZdd0DhDhDhdh
--####dDDDdXS90dh0GOSPZZXZUZXZXZOOSSY;79@@@D;Pbh0DEbbDb#bMMMS@;  ;.::7: 7P5c7;;YXM8v75S22XOXOZX5FPG95ll5lll5l1U8hd0DhdDDDD
--bD8d#ddhd9#dGCFFGE0EGXGZGZGXXUZOUCCl7;7DD.P@MbddD9bb#8##M@0M. 7;.,v7.: .;;,vc5d0l755F2UOXOXUGXPXPZls5lSFF1llSDbDd0Dhdh#h
--bb#bDdhdh##OTlllcTsOZGXZFOZGZZUZOU22517;.5@@M@DddhP#D#8Dd@MM :Y,:vY:Y;.7,777Uh@d7l52FXUXUXXXUGXEGETllSSOEd251ZMbDdhD0dD#
--8d8##DdhdDhl555llSGP9ZGZGl1U9ZZUZUUOUCClv;7@@@ME#D9P#d8bU9@b7v,;Y7;T7,T1,557UM@XclC2UUXXZUZUGZEZPE5vlllv1#E1SlZ88D#hDD#D
--b8b8##hdh#P51S1S98PEE0PPGGccC9EZUXUXFXFFSl;;h@@bZ8dh9bUhPFM@Z,;T7Yl27c@h;M@##MM5TS2UOXXZXZUGZGZE9hZS1112ED555Sl298##hddb
--8#8b8ddhD#915lSh#FlT15OG09GcYlXGGUUUXOU2O557:Y8@dG8DEP9l#9M@S;O71llFS#@@;c8@@@@F52UUZUZUZXGZGZE5CXhhdhD0E555515s12Ph#Dbd
--b8#8d8D#h8E555Zb5ss1llslS9hZcvvSZPZZUXOUCFSSY: M@hPbP29G508@5XS1E7@@@P7v;77lSUXUCXOZUZXGXEE9GPE5Yll55C51lll5SZPDhD9Ddbbb
--M#8#bd#D#bEl51ED5cl5215lllXDZcTcl2EGZOUOUC2SSv,v@@dUEOSG0P#dEDX@c.D57:7Y515lll5CXUZXGUZXPPXs2902sl1l1sls1SEh88Md#Dbd##M#
--bb#8d8##DMU55S59DGUhO515llc2hXTsTs1ZGGUXUUCC557:@@MdCFZXE88#8@@M  ,;7l5C5CCFCUOXUXXZXZXEPCcTl909lTslTl5X9bbbD#DdhDh#d8#8
--8#M#b#b#8dO1C55lXE925151555cS0GclsTcCXEXXFFSC51;7@@DDU2ZM8MM8EX;;Y11S5CCOFUOXUXXZUZUGXEP2c1llS0h022CZPdd#DdhDhdhdhdd8#Mb
--b8bMbbd8MEl1l5l1ssTl1S5S5555TS9GTTTlvl2PEGOOS25s:C@@Z09UUb@@Y :7lSC2CUFXUXUXUXUZXGZEGPPZs1l5ll1G9h0D0d9DhD0dhdhdDd#b#MbM
--8#8#M#8bh5UG90D0PUO5ll55S5515sShElcslcTsOG9XOC25T;D@@0P0d0@@l71522UOXUZUXOZOXXZZPEPO5U05sl5l1lTcSZ0909h0D0DDdhdDddb#8#Mb
--bbbMb8#bh8M@bM#8#8##EX1l1S5515TFd95TTlsTv12EZZ2O5TY@@@bb#M@@T52OOZUZXGUZXZXGG9GPU2lvs0P1s1l1T1CE9hP99D9D0DDDhdD#db#8#88M
--8#M#8#8#Mbbd#DdhdhDhb#dX5l55S55sZDhFsvlllcTsS2XXXC15M@@@@8@Z1FUUZZGXEZEG9EPGZ25sTTTcZ0XslsllFEd00P0Ph9DhDDdDdDdd##8bMbMb
--#8b8bMbM#b#8d#D#D#hDhDDbhXl15C5ll900Z5csslTlcssSSFO2Sd@@@@DOOEGPG9P9P9ZZFC1lcTclsscF0h1Tc120hhP990900D0dhdh#Ddd#dbb8b88M
--8dMb8#8#M#b#bd#D#D#hD0D0##0Sl1S112DP09XlTTll1llTlsll1lC2OSFOGXGXXF255slcTTssll5lsvF9hScsUPd00P9P09h0DhDDdhdDdD##b#MbM8Mb
--#bb8bMbMbM#8#8##d#d#DdD#DddbX1lSl5Ed9hhhU5cll1l1l1slssccvsTlclcTvscsclTlsll1l1llcF99ClF90h90P0P09D0D0dhd0dD#D##bb8#MbM#8
--bdb#MbMb8#Mb8#bdb##D#D#D#D#d89SlSlFDh909d9Z5ls1l5l5l5l1l1slslTlslslsll1l1l5l1TslX99XUPD9090P00h0DhdDD0DhdD#D#dbbM#8b8bM#
--d##M#Mb8bMb8b8#bdb###bD#Ddh#DM#Ol110DhP09hDDEF1ss5l51515l515l5l1sll1l5l5l5llTlC999E99090Ph0dDDhdh#D#DD0dDbd88M#MbM8Mb8bb
--bDb#b#8b8#Mbbb8#8#8#M#bdbDdD#h8#ZllObhh9h000DDhXF1lsll515l5151515151515l1sllOEd99E0P9909hhd0hM8dDD@0dd#D##8b8bM8MMMMMbMd
--DDd8dbb8b8b8#M#b#b#8#8b8dbd#DdDbbPl5hd0D9h90900dDDEU55sllllll1l1l1llslsl5OZDDD9h99Ph0hhhhdbZYPPM9TZsD8db#8b@1G@MMbv@8M##
--#h##b#b#8b8bM#bb8#b#8#8#8#bd#ddD#8hlZdd0D0D9h9h900Dhdh0ZU225S15155SCOOP9dD#0h909h0D0dhDhdhMUYd7h@Z7#@#b#8bM@lX@8@bY@@bbd
--hDdbdb#M#bb8bMbMbb#b#b#8#8b8dbD#d#bDP#hD0d0Dhd0D0DhD0dD###Ddh#hdDdD#dbD#hD0hhDhD0dhDhDD#Db89lX5M8b5@8Mb888MGs8@O#MsUGMdd
--#0dhdh##b#b#bd#db#bdbd8#b#b#b#bD#Db##hDhDhD0D0D0h0DhDhDhh0DDdhDhD0D0h9h9h9D0D0Dhd0DhDhdh#h#b@#@b8bMbbdb#8#Mb@M8d8bM#b#d0
--
--
--                                                                                                     .Y..                                 
--                                                                                 .:vXgdBBQKgs.     XQq.i:vJ                               
--                                                                          ..KRBBBBBBBBBEX1BBBD1.:1BBP:7:7YQ2X.                            
--                                                                    iY7BBBQBQBBBBBdr     5QL..rBQBB   7Md1QgQ:                            
--                                                                 YgBBQBQBQBQBBu::         K    UBBR   7UPQB.B:                            
--                                                           rYRQBQBQBMBQBBBi77.            M    PBBQ   . iBL77.                            
--                                                      .iMBBQQQBQBQBQBQQgi       i:.       BuJSBBBBB  ... .i .r                            
--                                                :bv:rZQBQBQBgBQBPBQE:         qBQBQB:.iUuU.7iSr7QqrrKBBBQKvJ5ggB                          
--                                      .:. .vZQBQBBBRBQBQqiBQBQr.      rIqY:  Sq.XBBQDPI:  .ui  .r PQBBBQBBBQBQQ:                          
--                               .::.rPJqdgdEBQBQBZBPgBBQBQBRP:      rYUQBBBQB:Q:.:jr.     .dU   P  :siIBBBBQBQLB.                          
--                      .     .KSIBQMQJBgsiUBBQDBMQdDQBQBQQs.       :q    IBBgKii:JL       ig   2v :U5: .QBgB2gEBB.                         
--                   rBBQgI7riULiQK7MZ7BQS7BMBZQRBQBQBQZ:    :LdQBBQR  :77ri..   :d        75   E  s7I   i jIB.BIBD                         
--            7:IJu5BQB7iUgXIiJrgLsRrvBddMBBBQBQBQBPY.      Qi  vQBQBiuuY:.      P5       .vI   Z  i71  g   uQiZvQB                         
--       . ..QZdSiIBEP1rr1Mq.1vYYdq.rD52dP5BQ5YSir         P.  :7dji.:.          d7        7s   Q  YIJ .B   iB:ELBQ                         
--      rrJK1s7uJj571IQE vBviQ:UMvB.UQBBB2d.         .::7r:R2YqYZ                U7        iY   Dr .1iDPBQi.2B BYQB                         
--    .B sq::7.Yi5 ..IBBvvQgdb5PDggBQDbLiX     ..IRIrPPMbPqP:  j.                Su ::irr1Y:U    B  i17vMBQBB.2BqBP                         
--    QdJgv.:.rr17 5i7Q2B:sIDr7E.Ysru7r:    .jRRP:.idZr.  U   :K          i..:vr1SB:17I7KuugQL   .QiQ1i:ii:rvqBuBQ                          
--    QSgQqi::77YQ.L:Ug:.QSMggEXrIUr..  .L2QQB7: iqj     2.   v:   .::vviqQUJJ5uIvd5:vXPbgXv5B:   .IKXRP7EQBBBIZQQrEX                       
--    .rirKZKJB:KgErrLQBEPj1dPQPJ.:    U:  L5   Lq.      P    Ld7S7JjSP2qPEXUvri7JsKEQBb.E.s::B.    :2QBBQBQYiMQBQBQi                       
--   vr.j1Ud.rQuu5EBJJ25DB7:          QY.irU.JQ q:     ::s:YvPYQPduSrr727vs1KPEBQBQBQi7v : vBr:BX   .u:LgBEREBQBBBQB                        
--    iijDU  .X1BrU2PIRUi       . ..:.BUQ.B :gBiS...7rYsR7Z7MBjrIIgZgdQRQQBggqBQBQBQ:  1   :BQE BQv     7qZvbMBBRXBZr:                      
--        .     .i        .UQBQBZQurrBQ K Qi YQjQKZDEDEUQBQgvviBQBBQ7BQBBBQBQBQPJL:. UBBM1srBBQB LBBPu:i:77UQBuBBi:Qd                       
--                     :PQBQ.IP      YB E Ki:iBiKSBBBRBddvX: 71Qu7B LQMdBDQQBr:     YrX.vbBQjQBBB::QBQBQBQBQi rBBQ2iBQ.                     
--                 :SQQQL5i. r   .:ii uii:.UsSQBQM:  :       .QB EQ QB     UBr      B : rBQu5BQBBBX..  .BBQB .QBQBQd:Bq                     
--             .vvBsb7irq.  BvrYJv7:7..D   Pj QQBr  .J7qEDBdr rQ.L. s   iZr BQ      P.7  1BuBQBBBQBQK7  BBBQ  BBBQBQBDSv..LYi               
--          :uJriJrr:Y iQ  .dr..    .v Dr. :2 .L.JPBBBQPLgQBBBiUr:.i:rQY:BQ BB       BQ:  LBLXqKSXvIK ..1Li::dQBQBBQ.iJMB: :B               
--      v5J7Bqrq7Q25SQ7 B.  Prv:irir:i IBBBvi:i  .BQBg.iQBBZBMBgBIBQBQP: gv BQ     .ruZXs..                iBQBBBQB2  rvJis.BLriii.         
-- r7qdUQBYXP2QB qvr::  Q:  UK. .. .i7 r:gQ17S. :7BBQ riILrs::   .rBBBY  gd QB     .DdZbvgDBQ. rKBBUMQZBgb1QQi.v2  ..j7K:iv7:vrriPBE        
-- Ri7Y2 RS .:   u:     Q:  j:. .   .  ir7BPiQ.XY1r:. i:   7s .:   UuUi  QB:7B.     7vqv 1BQBQBBqLXQi    7i       .ri   EL        BQ        
-- Qr7ur:7r:7i.7:gR7sXBQ1BEPg:v2.:ZL.:I  B: ruB..  :        ...7. :BBBQ .Q   B      vL  :BBBQBQB:  P     gg ZYE   :i 1Q7  SPE7vv.:QU        
--:MQSBEgQuKZ7BQBqIS77BQK7vQB vIRYgBBB51grE. .7 B i:v         :r.i:vS.i.:.:r:Qi     ri.  gBBBQBB:  7     .Kii.:  i qBKd Y iQrPBQ.           
--budQiibU7777.ir7iqIqYbQ7iJX2 vJqM.Q7 RXSI: 1Q 7 :.5         gr     :75117s: YBb7v1J:ii.B 7QBBBQBBBQBBB     : i . BB d1L :i .BP            
--PSvZ55BJBRQiMbsI.v57vv:r2Ssqd5rUDiQ77BBBQQYBBZBE:...  r...  L r        :..: 5EBgBQRBgi j  YQQQBQBQBBBvQQ2..sB5Q2K.:i.qBQDQB:              
-- .  .775sK7gQZP12PusE2.L.QvrsPKviiru7XLLrLX2LdZQBdv. :.. .            .:   :Qv.BQBBQ.SQg5BBBQZQQQRDB  BBi  L2Qid:K L.::uBBQBQY            
--          1Kr:7vLDZ7PI1XuRY 7ivgX7sBrviiSbr...:.BKI:ru. . 7   .i   .. i:. rDBQ YQi   QBBBZMQP BZi:BQ  BQ.  Q QdiR.b:7.B7.UBQBQs           
--                 r vM7rrSErJvuSbIBYKPr:rbiY1Js.g7Prs2Y. ..7rr2i.::i::.r7:.iBQBq... vQBgBQBgQQ DB.Pr  7QBJ7rgs Qb7B.M2ui:d  BgB:           
--                   :.irIP.1Quqi7v5:XDP5 BvB7iQDBiBUZvQjSX1..  17Y.:vBdL:r:::.irirsdQqSBQBBBgBQ.r:   iQBQi7Lri  . .           Pv..         
--                     : iB.su.D:: K.M Yq.UiQJ.rrr.D.5rrQKbBQY:1jIQSrLvY   iv1YQDQbii:... .. .:v7..JJBQBQQ SuKXRdXqdgBDQZQUdDg5BSuJSIXIUrvJ:
--                        .  i :iP5 Bur7E:jiUbr7gXdiiri7di.gPjQvg1:SIQBQEXBQsPPIIL.   :r2rvPP7vv5PqXSi:::.SZQQBQBQBBBQBQBQBQBQBq5BBBBQBBBs  
--                                : . .i:D r.7:QYiS.ibIvBiYdrBURii7siKBrjb2B.SBZPUPdsRBjBEvBQQQs..   ri7vKv7.::.:i::.::i:vv1:L1dQBBgL:iqZ57 
--                                        i  7 : .B2:1bLsrr:Pj Z:X5:v i5udQ:.gBr7JIgBQ.v7XJIiDXU. J1KSBBM1BQqBBMD:777v5i:i:.i:ir7rr.        
--                                                 ...i Yu  Pii1gv2u7ZP:QUBiPBMXZ.PBY5KggSiSiJiBQBXrSrqB5X.LRPur.:.77EMBQBQBBBZKi:r:        
--                                                          :.     i: u.vi:LJi.r:7.i: :IS:SrB:J..Bi IQ.d:5UrBBr7BQBgB7jr2vB:2:              
--                                                                                                    .  v   :. . .                          
----New series of simple scripts that just work..nothing fancy 
if myHero.charName ~= "Kindred" then return end
require "DamageLib"
keybindings = { [ITEM_1] = HK_ITEM_1, [ITEM_2] = HK_ITEM_2, [ITEM_3] = HK_ITEM_3, [ITEM_4] = HK_ITEM_4, [ITEM_5] = HK_ITEM_5, [ITEM_6] = HK_ITEM_6}
local castSpell = {state = 0, tick = GetTickCount(), casting = GetTickCount() - 1000, mouse = mousePos}
local barHeight = 8
local barWidth = 103
local barXOffset = 0
local barYOffset = 0
local sqrt = math.sqrt
local function GetDistanceSqr(p1, p2)
    local dx = p1.x - p2.x
    local dz = p1.z - p2.z
    return (dx * dx + dz * dz)
end
local function GetDistance(p1, p2)
    return sqrt(GetDistanceSqr(p1, p2))
end
local function GetDistance2D(p1,p2)
    return sqrt((p2.x - p1.x)*(p2.x - p1.x) + (p2.y - p1.y)*(p2.y - p1.y))
end
local function CircleCircleIntersection(c1, c2, r1, r2) 
	local D = GetDistance(c1, c2)
	if D > r1 + r2 or D <= math.abs(r1 - r2) then return nil end 
	local A = (r1 * r2 - r2 * r1 + D * D) / (2 * D) 
	local H = math.sqrt(r1 * r1 - A * A)
	local Direction = (c2 - c1):Normalized() 
	local PA = c1 + A * Direction 
	local S1 = PA + H * Direction:Perpendicular() 
	local S2 = PA - H * Direction:Perpendicular() 
	return S1, S2 
end
local function ClosestToMouse(p1, p2) 
	if GetDistance(mousePos, p1) > GetDistance(mousePos, p2) then return p2 else return p1 end
end
function SetMovement(bool)
	if _G.EOWLoaded then
		EOW:SetMovements(bool)
		EOW:SetAttacks(bool)
	elseif _G.SDK then
		_G.SDK.Orbwalker:SetMovement(bool)
		_G.SDK.Orbwalker:SetAttack(bool)
	else
		GOS.BlockMovement = not bool
		GOS.BlockAttack = not bool
	end
	if bool then
		castSpell.state = 0
	end
end
class "Kindred"
local Scriptname,Version,Author,LVersion = "KindredExpress","v1.3","Tocsin","8.6"
function CurrentTarget(range)
	if _G.SDK then
		return _G.SDK.TargetSelector:GetTarget(range, _G.SDK.DAMAGE_TYPE_PHYSICAL);
	elseif _G.EOW then
		return _G.EOW:GetTarget(range)
	else
		return _G.GOS:GetTarget(range,"AD")
	end
end
function Kindred:__init()
	
	self:LoadSpells()
	self:LoadMenu()
	Callback.Add("Tick", function() self:Tick() end)
	Callback.Add("Draw", function() self:Draw() end)
	local orbwalkername = ""
	if _G.SDK then
		orbwalkername = "IC'S orbwalker"		
	elseif _G.EOW then
		orbwalkername = "EOW"	
	elseif _G.GOS then
		orbwalkername = "Noddy orbwalker"
	else
		orbwalkername = "Orbwalker not found"
	end
	PrintChat(Scriptname.." "..Version.." - Loaded...."..orbwalkername)
end
function Kindred:LoadSpells()
	Q = { range = myHero:GetSpellData(_Q).range, delay = myHero:GetSpellData(_Q).delay, speed = myHero:GetSpellData(_Q).speed, width = myHero:GetSpellData(_Q).width }
	W = { range = myHero:GetSpellData(_W).range, delay = myHero:GetSpellData(_W).delay, speed = myHero:GetSpellData(_W).speed, width = myHero:GetSpellData(_W).width }
	E = { range = myHero:GetSpellData(_E).range, delay = myHero:GetSpellData(_E).delay, speed = myHero:GetSpellData(_E).speed, width = myHero:GetSpellData(_E).width }
	R = { range = myHero:GetSpellData(_R).range, delay = myHero:GetSpellData(_R).delay, speed = myHero:GetSpellData(_R).speed, width = myHero:GetSpellData(_R).width }

end
function Kindred:LoadMenu()
	self.Menu = MenuElement({type = MENU, id = "KindredExpress", name = Scriptname})
	self.Menu:MenuElement({id = "ComboMode", name = "Combo", type = MENU})
	self.Menu.ComboMode:MenuElement({id = "UseQ", name = "Q: Dance of Arrows", value = true})
	self.Menu.ComboMode:MenuElement({id = "UseW", name = "W: Wolf's Frenzy", value = true})
	self.Menu.ComboMode:MenuElement({id = "UseE", name = "E: Mounting Dread", value = true})
	self.Menu.ComboMode:MenuElement({id = "UseR", name = "R: This can screw up a team fight..careful", value = false})
	self.Menu.ComboMode:MenuElement({id = "comboActive", name = "Combo key", key = string.byte(" ")})
	self.Menu.ComboMode:MenuElement({id = "DrawDamage", name = "Draw damage on HPbar", value = true})	
	self.Menu:MenuElement({id = "HarassMode", name = "Harass", type = MENU})
	self.Menu.HarassMode:MenuElement({id = "UseQ", name = "Q: Dance of Arrows", value = true})
	self.Menu.HarassMode:MenuElement({id = "UseW", name = "W: Wolf's Frenzy", value = true})
	self.Menu.HarassMode:MenuElement({id = "UseE", name = "E: Mounting Dread", value = true})
	self.Menu.HarassMode:MenuElement({id = "harassActive", name = "Harass key", key = string.byte("C")})
	self.Menu:MenuElement({id = "ClearMode", name = "Clear", type = MENU})
	self.Menu.ClearMode:MenuElement({id = "UseQ", name = "Q: Dance of Arrows", value = true})
	self.Menu.ClearMode:MenuElement({id = "UseW", name = "W: Wolf's Frenzy", value = true})
	self.Menu.ClearMode:MenuElement({id = "UseE", name = "E: Mounting Dread", value = false})
	self.Menu.ClearMode:MenuElement({id = "clearActive", name = "Clear key", key = string.byte("V")})
	self.Menu:MenuElement({id = "ALevel", name = "Auto Level up", type = MENU})
	self.Menu.ALevel:MenuElement({id = "Enabled", name = "Auto Level Up", value = true})
	self.Menu.ALevel:MenuElement({id = "Block", name = "Block Auto Level Until 2", value = true})
	self.Menu.ALevel:MenuElement({id = "Order", name = "Leveler Sequence", drop = {"[Q] - [W] - [E] > Max [Q]","[Q] - [E] - [W] > Max [Q]","[W] - [Q] - [E] > Max [W]","[W] - [E] - [Q] > Max [W]","[E] - [Q] - [W] > Max [E]","[E] - [W] - [Q] > Max [E]"}})
	self.Menu:MenuElement({id = "CustomSpellCast", name = "Use custom spellcast", tooltip = "Not needed here", value = true})
	self.Menu:MenuElement({id = "delay", name = "Custom spellcast delay", value = 75, min = 0, max = 200, step = 5,tooltip = "bah, your gonna break it", identifier = ""})
	self.Menu:MenuElement({id = "blank", type = SPACE , name = ""})
	self.Menu:MenuElement({id = "blank", type = SPACE , name = "Script Ver: "..Version.. " - LoL Ver: "..LVersion.. ""})
	self.Menu:MenuElement({id = "blank", type = SPACE , name = "by "..Author.. ""})
end
function GetInventorySlotItem(itemID)
	assert(type(itemID) == "number", "GetInventorySlotItem: wrong argument types (<number> expected)")
	for _, j in pairs({ ITEM_1, ITEM_2, ITEM_3, ITEM_4, ITEM_5, ITEM_6}) do
		if myHero:GetItemData(j).itemID == itemID and myHero:GetSpellData(j).currentCd == 0 then return j end
	end
	return nil
end
function UseBotrk()
	local BTarget = CurrentTarget(400)
	if BTarget then 
		local botrkitem = GetInventorySlotItem(3153) or GetInventorySlotItem(3144)
		if botrkitem then
			Control.CastSpell(keybindings[botrkitem],BTarget.pos)
		end
	end
end
function IsRecalling()
	for K, Buff in pairs(GetBuffs(myHero)) do
		if Buff.name == "recall" and Buff.duration > 0 then
			return true
		end
	end
	return false
end
function ValidTarget(target, range)
	range = range and range or math.huge
	return target ~= nil and target.valid and target.visible and not target.dead and target.distance <= range
end
function Kindred:Tick()
    if myHero.dead or Game.IsChatOpen() == true or IsRecalling() == true then return end
	if self.Menu.HarassMode.harassActive:Value() and self:EnemyInRange(900) then
		self:Harass()
	end
	if self.Menu.ComboMode.comboActive:Value() and self:EnemyInRange(900) then
		self:Combo()
	end
	if self.Menu.ClearMode.clearActive:Value() then
		self:Jungle()
	end
	self:Levelme()
end
function Kindred:HasBuff(unit, buffname)
	for i = 0, unit.buffCount do
		local buff = unit:GetBuff(i)
		if buff.name == buffname and buff.count > 0 then 
			return true
		end
	end
	return false
end
function Kindred:Levelme() 
    if self.Menu.ALevel.Enabled:Value() == false then return end
    local Sequence = {
		[1] = { HK_Q, HK_W, HK_E, HK_Q, HK_Q, HK_R, HK_Q, HK_W, HK_Q, HK_W, HK_R, HK_W, HK_W, HK_E, HK_E, HK_R, HK_E, HK_E },
		[2] = { HK_Q, HK_E, HK_W, HK_Q, HK_Q, HK_R, HK_Q, HK_E, HK_Q, HK_E, HK_R, HK_E, HK_E, HK_W, HK_W, HK_R, HK_W, HK_W },
		[3] = { HK_W, HK_Q, HK_E, HK_W, HK_W, HK_R, HK_W, HK_Q, HK_W, HK_Q, HK_R, HK_Q, HK_Q, HK_E, HK_E, HK_R, HK_E, HK_E },
		[4] = { HK_W, HK_E, HK_Q, HK_W, HK_W, HK_R, HK_W, HK_E, HK_W, HK_E, HK_R, HK_E, HK_E, HK_Q, HK_Q, HK_R, HK_Q, HK_Q },
		[5] = { HK_E, HK_Q, HK_W, HK_E, HK_E, HK_R, HK_E, HK_Q, HK_E, HK_Q, HK_R, HK_Q, HK_Q, HK_W, HK_W, HK_R, HK_W, HK_W },
		[6] = { HK_E, HK_W, HK_Q, HK_E, HK_E, HK_R, HK_E, HK_W, HK_E, HK_W, HK_R, HK_W, HK_W, HK_Q, HK_Q, HK_R, HK_Q, HK_Q },
    }
    local Slot = nil
    local Tick = 0
    local SkillPoints = myHero.levelData.lvl - (myHero:GetSpellData(_Q).level + myHero:GetSpellData(_W).level + myHero:GetSpellData(_E).level + myHero:GetSpellData(_R).level)
    local level = myHero.levelData.lvl
    local Check = Sequence[self.Menu.ALevel.Order:Value()][level - SkillPoints + 1]
    if SkillPoints > 0 then
        if self.Menu.ALevel.Block:Value() and level == 1 then return end
        if GetTickCount() - Tick > 1200 and Check ~= nil then
            Control.KeyDown(HK_LUS)
            Control.KeyDown(Check)
            Slot = Check
            Tick = GetTickCount()
        end
    end
    if Control.IsKeyDown(HK_LUS) then
        Control.KeyUp(HK_LUS)
    end
    if Slot and Control.IsKeyDown(Slot) then
        Control.KeyUp(Slot)
    end
end
function Kindred:IsReady(spell)
	return Game.CanUseSpell(spell) == 0
end
function Kindred:CheckMana(spellSlot)
	return myHero:GetSpellData(spellSlot).mana < myHero.mana
end
function Kindred:CanCast(spellSlot)
	return self:IsReady(spellSlot) and self:CheckMana(spellSlot)
end
function EnableMovement()
	SetMovement(true)
end
function ReturnCursor(pos)
	Control.SetCursorPos(pos)
	DelayAction(EnableMovement,0.1)
end
function LeftClick(pos)
	Control.mouse_event(MOUSEEVENTF_LEFTDOWN)
	Control.mouse_event(MOUSEEVENTF_LEFTUP)
	DelayAction(ReturnCursor,0.05,{pos})
end
function Kindred:Draw()
    local textPos = myHero.pos:To2D()
	if self.Menu.ComboMode.DrawDamage:Value() then
		for i, hero in pairs(self:GetEnemyHeroes()) do
			local barPos = hero.hpBar
			if not hero.dead and hero.pos2D.onScreen and barPos.onScreen and hero.visible then
				local Qlvl = myHero:GetSpellData(_Q).level
				local QDamage = ({60, 80, 100, 120, 140})[Qlvl] + 0.6* myHero.bonusDamage
				local Wlvl = myHero:GetSpellData(_W).level
				local WDamage = ({25, 30, 35, 40, 45})[Wlvl] + 0.2* myHero.bonusDamage
				local Elvl = myHero:GetSpellData(_E).level
				local EDamage = ({65, 85, 105, 125, 145})[Elvl] + 0.8* myHero.bonusDamage
				local damage = QDamage + WDamage + EDamage
				if damage > hero.health then
					Draw.Text("killable", 24, hero.pos2D.x, hero.pos2D.y,Draw.Color(0xFF00FF00))
					
				else
					local percentHealthAfterDamage = math.max(0, hero.health - damage) / hero.maxHealth
					local xPosEnd = barPos.x + barXOffset + barWidth * hero.health/hero.maxHealth
					local xPosStart = barPos.x + barXOffset + percentHealthAfterDamage * 100
					Draw.Line(xPosStart, barPos.y + barYOffset, xPosEnd, barPos.y + barYOffset, 10, Draw.Color(0xFF00FF00))
				end
			end
		end	
	end
end
function Kindred:CastSpell(spell,pos)
	local customcast = self.Menu.CustomSpellCast:Value()
	if not customcast then
		Control.CastSpell(spell, pos)
		return
	else
		local delay = self.Menu.delay:Value()
		local ticker = GetTickCount()
		if castSpell.state == 0 and ticker > castSpell.casting then
			castSpell.state = 1
			castSpell.mouse = mousePos
			castSpell.tick = ticker
			if ticker - castSpell.tick < Game.Latency() then
				SetMovement(false)
				Control.SetCursorPos(pos)
				Control.KeyDown(spell)
				Control.KeyUp(spell)
				DelayAction(LeftClick,delay/1000,{castSpell.mouse})
				castSpell.casting = ticker + 500
			end
		end
	end
end
function Kindred:Combo()
	if (not _G.SDK and not _G.GOS) then return end
	local target = target or (_G.SDK and _G.SDK.TargetSelector:GetTarget(1000, _G.SDK.DAMAGE_TYPE_PHYSICAL)) or (_G.GOS and _G.GOS:GetTarget(E.range,"AD"))
	if target and target.type == "AIHeroClient" then
	if self:CanCast(_Q) and self.Menu.ComboMode.UseQ:Value() then
            local c1, c2, r1, r2 = Vector(myHero.pos), Vector(target.pos), myHero.range, 800 
            local O1, O2 = CircleCircleIntersection(c1, c2, r1, r2) 
            if O1 or O2 and target.pos:DistanceTo(myHero.pos) < Q.range then
                local pos = c1:Extended(Vector(ClosestToMouse(O1, O2)), 420)
				self:CastSpell(HK_Q, pos)
				--Control.Attack(target)
            end
	end
	if self:CanCast(_W) and self.Menu.ComboMode.UseW:Value() and not self:CanCast(_Q) then
			if target.pos:DistanceTo(myHero.pos) < 500 then
			Control.CastSpell(HK_W, target)
			end
	end
	if self:CanCast(_E) and self.Menu.ComboMode.UseE:Value() and target.pos:DistanceTo(myHero.pos) < E.range then
		Control.CastSpell(HK_E, target)
	end

    if self:CanCast(_R) and self.Menu.ComboMode.UseR:Value() then -- Should leave off auto..great to burn enemy cd's tho
            if myHero.health/myHero.maxHealth < .20 and myHero.pos:DistanceTo(target.pos) < 500 then
			    Control.CastSpell(HK_R)
            end
    end

    if self:EnemyInRange(400) and not self:CanCast(_Q) then -- used twice so stays I guess
            if myHero.pos:DistanceTo(target.pos) < 400 then
			    UseBotrk()
            end
	end
	end
end
function Kindred:GetEnemyHeroes()
	self.EnemyHeroes = {}
	for i = 1, Game.HeroCount() do
		local Hero = Game.Hero(i)
		if Hero.isEnemy then
			table.insert(self.EnemyHeroes, Hero)
		end
	end
	return self.EnemyHeroes
end
function Kindred:EnemyInRange(range)
	local count = 0
	for i, target in ipairs(self:GetEnemyHeroes()) do
		if target.pos:DistanceTo(myHero.pos) < range then 
			count = count + 1
		end
	end
	return count
end
function Kindred:Harass()
	if (not _G.SDK and not _G.GOS) then return end
	local target = target or (_G.SDK and _G.SDK.TargetSelector:GetTarget(1000, _G.SDK.DAMAGE_TYPE_PHYSICAL)) or (_G.GOS and _G.GOS:GetTarget(Q.range,"AD"))
	if target and target.type == "AIHeroClient" then
	if self:CanCast(_Q) and self.Menu.HarassMode.UseQ:Value() then
            local c1, c2, r1, r2 = Vector(myHero.pos), Vector(target.pos), myHero.range, 800 
            local O1, O2 = CircleCircleIntersection(c1, c2, r1, r2) 
            if O1 or O2 then
                local pos = c1:Extended(Vector(ClosestToMouse(O1, O2)), 420)
				self:CastSpell(HK_Q, pos)
				--Control.Attack(target)
            end
	end
	if self:CanCast(_W) and self.Menu.HarassMode.UseW:Value() and not self:CanCast(_Q) then
		if target.pos:DistanceTo(myHero.pos) < W.range then
		self:CastSpell(HK_W, target)
		end
	end
    if self:CanCast(_E) and self:EnemyInRange(500) then 
		if self.Menu.HarassMode.UseE:Value() and QTarget then
			Control.CastSpell(HK_E, QTarget)
		end
	end
	end
end 
function Kindred:Jungle()
	for i = 1, Game.MinionCount() do
	local minion = Game.Minion(i)
    if minion and minion.team == 300 or minion.team ~= myHero.team then
        if self:CanCast(_Q) and myHero.pos:DistanceTo(minion.pos) < 700 then 
		    if self.Menu.ClearMode.UseQ:Value() and minion and myHero.attackData.state == STATE_WINDDOWN then
            local c1, c2, r1, r2 = Vector(myHero.pos), Vector(minion.pos), myHero.range, 700 
            local O1, O2 = CircleCircleIntersection(c1, c2, r1, r2) 
            if O1 or O2 then
                local pos = c1:Extended(Vector(ClosestToMouse(O1, O2)), 420)
				self:CastSpell(HK_Q, pos)
				Control.Attack(minion)
			end
		end
		end
	end
	if self:CanCast(_W) and minion and myHero.pos:DistanceTo(minion.pos) < 500 then 
		if self.Menu.ClearMode.UseW:Value() and not self:CanCast(_Q) then
			Control.CastSpell(HK_W, minion)
		end
	end
    if self:CanCast(_E) and minion and myHero.pos:DistanceTo(minion.pos) < 500 then 
		if self.Menu.ClearMode.UseE:Value() then
			self:CastSpell(HK_E, minion)
		end
	end
	end
end
function OnLoad()
	Kindred()
end