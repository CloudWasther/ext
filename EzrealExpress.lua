----New series of simple scripts that just work..nothing fancy                                       
--
--.                                                                       xUXc                                                                          
--                                                                         ;s2c.       :                                                                
--.                                                              ;.         ,ssUtc;    rB2                                                              
--                                                               ,#@Hc;,      csZUcT:  ,S6g                                                             
--.                                                                t@B@BD2r    C;iLjTt..ssSF   .                                                        
--                                                                  ;@BbbHDgr   U:cFcc0FrjsPF  .       ...                                              
--                                                                   rUnSPng@tr ri:7T;CUr7LSn:   .rtnsOnSxxstSntncr:                                    
--                                                .rtXZXF2xStj7r:,    rsCU27Fdntrc:;rriTrs5ssrTs5Fr;:;rrr;;;;:,:;rr506t:                                
--                                            ,cgXZs7:.     ..::;ricT;rr5US5rrO0jr:.;rrx7L5TiF0r.;c5OCjjsccrjstcirir;;rLZ;                              
--                                         ;tCi;.  .:rit5nCFS5jr;:.,,cgSrxgins;tZs;..r7s;s5nPL  g@Sr;,..       ..;rTCnc: r0;                            
--                                      ,SUi.  ;jF6ggOX5Lrr;rrrrccCc:  ;XsLX;Lcrsnxr,.rL;7CB; .bB;,.:::,,....       .;LXU  0r                           
--                                     Zb;  ;O8B0Cr;;,.      . ..,:s2;   Z;rC;crrxOt;,:5irZS .7@,,::,,,.,... .       ..;Xn  8,                          
--                                   c@7  rd8Fi;:,,.. ..,..         xL.  TO:ixiL;rLnr;rrr;B8.,rPr.                    . rn: Ct                          
--                                 ,F@;  sdn;, ..,,,.              ;;,.  dPrxTLxc7r57rU;.;B@L. ,iTi.                    ri. Zr                          
--                                tFdj .;UX;.   ..,             ,;:    .cB; ;cZji,;;5rci;r@:;gT   ;rr;               .:;; .,H;                          
--                              x0c 5c.;::;;;;;;:;.... . . .        ;r;rbB, .rj2n0Pd@DXC7g; rC@@X;    .,:r7r;.  .,;rc7;. .:,isO.                        
--                           ,SPc..:5Xjr;...,,,.,,...           .;r;, .#bini.j@#PCi;;;;. s;jHtTcFb#xc.  ;. ,:;i         rc :r5St                        
--                         rFi   rtXiLOO5tciiT;,........:;:Lci5x7;   xBd;;0x:CP,     .   ; cX2ZP5rrTi;c0  ..;  L;,,;rcSO87;r2@Xg                        
--                            .;cOdx,:LXdXZSFSXZnCCcirr;;;UL     .rrPXr:r50nr7i .;LCOSXt;r ;x:rTxxFxc:Sc gi ;2 x;  ;7tC;r7,FcscX                        
--                          :srCHX0i  ,,rg;;r;;rr;;r;;,..s. ;i;.  ,t;..cO2Zx;rsgB@Bdn5L088rsSrrir;:;;rZ2;Zr;jg.ZrrcTLcir,FnSct5;                        
--                         tUi2PtZB;  i. scrr;;;;rrrrr;,;i .XrrsC; .rrEBBB@B8B@B#06ZFjr,TOPFT;;rTir;;:iLr;CUXrrL,        .rs5s;.;;,                     
--                       ;Ctjt7t8D6C .75 tF7cLTsTLjirr;r;STTBj;;nL;ssr5sijsZFPEPjcF2XPCiiitO#Frr;rj2r;.,ii:;r5T;rr;rrrrr;;;is@Br.. :,.                  
--                     ,rscTi;OB8SgU7gXLgxr;7rrrrrr;::::;rUcxZssU;jUgFts5xStCsxCUCSC200istLL8B@SSb@bL;cr;:;iscj7j7rrCL:,:;riTs@BPi,                     
--                   ,irc6Xi;n86ZsZ0bUrLsr;rrcTsLLTsLsccir;ri7rr;xDxUBHDd6EgXH6ZCUF0Oc#FrFTTSBnXbB6D00#BgUUP0OCStxS02iE0O5COxji2B86#L.                  
--                 ;tT:;FgTrUggFSrFDPc;.csc,    ,.,,:,,.   ,Lsss5cr;;;;:, .,;TL5CcXZtxg67C6UnciLcrisOB@B6OF5i;;;r760s;5XOjcsXtcscg@b0sLcr;.             
--              :jji:  ZdirtxxxSjLF#SccrS@b8PgFc;;...:,;;;:.,;cEUCrrctrr:       .;iDSc5n0#Tcc;;;;cLSEs:.,;.. .;5d@BH0Z5Usj;rsnCs5ntEE:   ;;:..          
--           :r;,     tBjTSCtt#tStZ#sT7;0BFCZ6BB@B@BgSSCsiSEPPXT5sgExrrrt#@dXxr    .CPiX@tsr;:rcr;;:  .;ssriUHDZ2Cs5SUZtLcjcLcjijr7jn8U,                
--         .         rB2cg2Cc@6ScF8Etg;:SZcCS68B@@B#H6scrUB0CLjiCCr;;CLrXgn6d8B@n:   rb@gi  .::;;Cc7;cSCtsr;;it2ss;.,;:;;;;r;;;ir7LtsjC8S;              
--                  .@Fr8cr50BD7C0HgZ6Tj68dP0X6#dP#8@Ennni;rrrcTTrriS5xZFtSStrsg8B8;  FB#  rrir2OjXnHB@Xr:r;;;r;7g85..rsdB@B@D2sLrTctt550POc:           
--           :.     E676r;igX@jt8UgBC5C6XCjLsxZdDb#@crccrrcFx5cUjicrcXZTjLTLrrt5sBB@B.r@;,#biT;;;;r5rrx@B@HHFr;7r;i@#E0gP6OOnPb8#OjTcsxFnXPdHFc;        
--           ,PB@B6dSsOsrs62dSrcirrcrrrrcc2OUnEZ0D@0xFX5ZEDXtiT;rL;:ns:;r;;.:rrjBB@@@BBBtB@cHjr:;;rc77.;i8@rcgUirr;rB2:;r;;;;;rcSO#0SscTLsCt5LsSZT;     
--              ;CE025r;;j2UsstsTjsscccjxSLOPnxZD#XDEd808P;.:;,;;  ;:  .    r:r2B@DBB@@@B@B;r8;r;:r;:i;rrr6b,.;nDC;:rBL;;irr;;:;;;;cjtcj55Tjc7rristF5Tr 
--               ,FSriLTsri7rrr;;;;;;;ic7igFirCXtL#O0HiTx, .,              :;,sx;.,:;rU@@B@s;gtr;.;.: 7;trCBF,;.PBH;,iPrr;rrir;;:,,,;;;7sLsj5LLir:.     
--             .jHgjcjTXS5FjrrrrrrrTsUZsC#r,t2sssgOFt;.r         .      . ,r,rZr,;;;:,.;:;Xi;rd,...   ;;srjHU,;trr##t,siisc7rrrcrr;r;rrr;;;7rr;ricii;:  
--          :;iXHZ7rTLUU6Ziricicc2Ot68HX8;;F5icgDBsr; .         ..   .r ;;ri;tn,:;;;:::.. c; ;@  .    . s;rTx.rPt,LSHjLr  .   ,:;;rrr;;,....,;rr;.      
--     .:rir;rcrLLrc7icCLTCFndHZxFXdxcx6s.rr7L8DBxr  .   .    .. ...:Tc:rcstrC; ,;:,.:,, ,t. L2 ;.,.    j;;rc:5Sr5;CEFOZ7S5r;, ,       .:;;:.           
--;;P6dXj;;rr;;rLrirr;;r;rsCtTcsCFZcr;sH;.:c7gXxS;  .:. .;,.;,, .::r, gTxr;255:   .   .  ir  B;:;:;.. ,.t;;j;;OTrcxr7Xjxsd@b08DxxEB@@#L:.               
--      ,ri7;,;:;;:;;rrsSSiirisxjj:,;LBs,;x;TOsX;.  ;:. :;;;rrrrcrr:  2gT  ZxL          ;jr.Z@.r;;;;,;,:L;ri jT7trCFrr0LrcTjr;r;;sHSH@BbS7;:.           
--    .rr:,   .,rc55O5sUFisCn5ssFsxn8Bgr;xrrTsLL . :;;  ;rF rtT:Ojr   ;#r  iLi          c;rU@,7c:;r:;;rt;Ts:rdxisjin2,iZ,csTLLr;rrtT;jCxFjsir;ric;;,    
--  7CLLr;;;rLt2xcir;rii;cCH6HB@bPb@BX;;crr5jjt:.,,;;, ;rF; sF. Es     Bc  ,Xi         i;Tit;rtr:;.r;;7c;nrsb@B6i;iLs7 Cr;5rTFtirLrC:;ist2Tx2xLr;.      
--XsP6XnFSU2Z2s7r;rrisUZPEZFxCS;,iDBP: ;;:jSciU:,,::;: ;jS  xc  D:     rt   Z5        ;i0;.rcc;:;:rLrrciiriB@#88@c .sO;;n;Sccj2srijLn;rr;:;:,           
--SsOO2t52sTr;:;;rFHgg2Cr;;rcLr;c8DL, ;;,ctcrCU:.T;rrr ;g   r. ,S       L   rO       iCS. cCr;, ;7;;srxrrXB@EcXXt@s  UC,ccrC7Urn;c57bi                  
--    ......;rrrEdsrrrcrriF2s7;r#Es. , ;CU;irTF ;xrcc, xDXDxPSrsO:,   . ;.   E:    :T;:  F2r;: ,c. irrtr#B08cjLCic@5  2rrT;T7C;i;:S;gP7.                
--       ..;:,. ...:rircccii;,,2UL: ;.:xE,rcrjC.rT;Lr  Xi56XObt2ZUS2Tr,. ... rx   .,   ,ssr;. .s;;c#Z#gPCnCg;Lr7Lr;@0 ;c;rrr7cc:c.jc5OS;,               
--Et5tZc;::;;;;;rcTrrr;,..;;  UBS, ::.LC ;si;ZT.ir;L;:r#8B@BDPOBD2ZC2FPSr..,: ,       ;rr;, ,r8OcrxinUg2OB@Drxr77i;i@t r.::,7i2 r,;LcTxX...             
--cc5CFScTiccircr7rr,  .;7;,,OBg, ;; rL ;Fir;dr:r;rxr2iDsr8x,CnxB..Cn5rsF6t;,;::,;:;;:,;:.;t2t;rcdDSxHd; ;rLrSr7,ti;s@: .::.;ri;;; irc;PZ. ,            
--    .:;;rr: ;;;;. ,;csi;:;UBc  rr ii ;Scs,rXrrr:jrrS5s  @r s#c6  . ;Lc;rLFFrir;;;;;;:;sSjr;rOOEBL;8BUs,  rcSi;,Tr;cs@   ;.;;c;r7,:rLrc0#;  .          
--       .;i;;;:;;rirsiLi;.rP;.;cc.r; ;tLsr,rxr;rrT7rrs5i;X@Fr,,rH@S  ,rsEC5L;;r;;;;;;;iUcLgUr   @Or:r ;B;.STxri;Lrr5ibi .;.;rc;;ts.:i;rEBBE            
--   :cSFc;;:;rr7r7rrcjr, ;Zrrcr; .  ijr;r:;rcU;risjc gc.:;j6B@#dP#Uji7;,.,.  ,:;:;;;;rTicLsjrrrrZ@BnZbbbCd;;.r;iciis;ZP. ..:;sr.isr;r   :C8@r          
--  rxCLrLsUjr:;;:.:;; .;C0;7jr,   .Ls;;: ;;r;Oriic5i L8.                     .,    .;TZr;.    ....;;;;; sT   ,;i;:Ci;S8r  . ;ic:;rir;;     .i.         
--       :cU6nc;r;;;;.;;5S;rr;.   ;xt;;.  r;;:SiictTi  B2                     .:      jr;:,              x,  .,;r :6;rjZn  ..:r;crc;rri                 
--           :rtZOLirr;5C;;:    ,sCr.;   ;rr,;cj;strr  rB ;r;rrrrrrt7,        .:     .i,,;,,.:r7;;;;;r;;0i  .  r, in.irUb  ,.rr;;iTi;:sr                
--                ,;;;OZcii;. ;isTr;;.  ,t;;;;;Zr;Ori   ;;c     7Ft;          .:     ,L,;;,.,.:cXHT,;,;BU:::. ,; ,x,rrrsb. ,;rt ;:Ucc;.Z;               
--               ,;;;cS7txs;.rtLcr;r,  .Cr:r;r.ZUrZri.    i    cT,            .:     :r:::....   rx,  iU;r,.  ;  L;;ir;rZ. :;CS;;:Exrr. i;              
--            ;Lnjjr;cctCr;rscrTcr;    ir;,c:r:5@P6nT,.   i .jF;              ,,     ;i.:.. . .   .SL7Usi;,  ;. ir.;rr;rX, ;iU;;;;xZrr,, .              
--         ,TL5jTr  iixsr;rt,.ijr:    ,C; :r,j:S0XdXt:..  rSL:               .,:     ;r,,. ..   .;: :tC67:  ;r ii,:r7T;U6, rsDi:r;sXLc,:.               
--       ,;;,      iLSs;  ;:,r5r:    .c;  : rr,tCisDg; .  .,                  ..     ;r.: . .      ;crPj:  ;c i5, ;TC;rdO: TZULtr.Tr;ir r               
--                Z2sr   i;:,ns.    ;c:.   :c;;;tc;r6P.                       .      :r..         20;FZ::.rL rt;  TC;;FDnT cXr:En.;r Fs  ;              
--               2E;   :xr  nc  .,,;X;.    :;rr:5sL;rB2                       .      .r:,       rBs rZrcriT.rT. ,5Trsggn6i LO::rUZ;i ;6;  ;             
--              7;    rT.  Cj,.; :,sr     ..;i;:r7xg,;Bc                    .;.       ;;..     Fg. ;nriLsr;xr..:ris0xCjsUi EnirirF2t  SC   :            
--             i.   ,r,   tir;r:;;,r       .;:  rit6C :8r                    ;:,.   .:r;.     ;.  ;jrr:;rcx;;r;rO6DCr5sSZ:;DOxr;2F2xr  8.   .           
--            ;    r:    sittLr7. ;r,      ;.; .LscZ0L ,c,                    .:;:.,:;:.         ,rj: ,rir;risC6E5riSxTgd:tssO6jigEnCr rP               
--                     ;STUSi.    T;.   . ; ., ,icj2n8r ..                                      .;r  r2jsc5x0ZjSLLsjTsOPE;iri rPHFXgF ;.xr              
--                    i0xL;      rr,.. ; r. ,. ;rrtSTDdr.,.                                      . ;SXiiT2gP6jjT7jijxtXFTr;:c:  ;FOPBx   :              
--                  :PZr.        s,,r ;.;, .. ,;crn5CSP#;..                                      :r;. ,7rTnXnst;irrTUtT5cC. Z7    rrj6n                 
--                 c7.          .i.r,,;rr :,..;ir77tCsC0#: .                 ...,:,;;r;,        .,   rnr;c6r;r;;r;cOcrrgT:  Es     ,;r,T                
--                ,             sxr;,7;7.;r,..rjs,;TT;5T0g,          ,bBBP2ci;r;:,;:;;iTscjs6n; . . rL;;;tb,;;;jrrxs:;dd;   U5       c.                 
--                             .6; rsC.r Lr, ;xS7 7Cr;c5s#P, ...       .:rLti;;ritj7rriLtUCSnL:..:.;;.ir DS;r;TLLCi. ZBr    iU        .                 
--                             Si ;CZ,.c:Si.;TP5  ir;;TTcFOH:  ..           .,:..   .:;;;:.   ..::.  rr r0;LCr5Ssc, rBc     ;D                          
--                             t  EPr 7rLj:;sHT  Tcc:;srrCc00r   .             ,,::;:;,. .........  j;  OsiU;5XTir  X6       D                          
--                            L  :@U  STx:iT8r  ,Pc7:;c;;rTiXbj.        . .  .. . ....,.,...,.,.  :;C  ,;OO;iOSrx  ;@        r.                         
--                            ;  rds ;On:j2@;   d7 r,rL;;;rrs0t;;;.          ..,.....,........  ,; ;r   r0;;XCrP.  dj                                   
--                               iO  jBirXb.   U5  r;js;,;;;Z8r, ,;;,         .....     ...   :r:  i,   n;;dFtO;   g                                    
--                               6r :@r gg    sZ   r;jr;.r;r6# r    :;:.           . ....   ,r;    t   .OcHrrOr                                         
--                              :D  @i n7    rt    7sj;;:r:rHi r.     .;:.            .    ;;      7   rBd .dL                                          
--                              cs Cs ,     .;     ;Os.rcc7;n  ;;        ,:,             :,.       r   B6  Pb                                           
--                              0, .                Dr iCrr;s   r           ,;:,,.,...;;:         :;  sD  ;B:                                           
--                              0                   Zr ZU; ;    ;               .,,,              :.  j   Ux                                            
--                             .F                   nr dX       ;                                 ;  :   ,#                                             
--                             :r                   cc HZ                                         . ,    n7                                             
--                                                  ,n cX                                                Z                                              
--                                                   7 .i                                               rc                                              
--                                                      r                                               O                                               
--                                                      :                                               s                                               
--                                                                                                     ,;                                               
--            
--                                                                                                     .Y..                                 
--                                                                                 .:vXgdBBQKgs.     XQq.i:vJ                               
--                                                                          ..KRBBBBBBBBBEX1BBBD1.:1BBP:7:7YQ2X.                            
--                                                                    iY7BBBQBQBBBBBdr     5QL..rBQBB   7Md1QgQ:                            
--                                                                 YgBBQBQBQBQBBu::         K    UBBR   7UPQB.B:                            
--                                                           rYRQBQBQBMBQBBBi77.            M    PBBQ   . iBL77.                            
--                                                      .iMBBQQQBQBQBQBQQgi       i:.       BuJSBBBBB  ... .i .r                            
--                                                :bv:rZQBQBQBgBQBPBQE:         qBQBQB:.iUuU.7iSr7QqrrKBBBQKvJ5ggB                          
--                                      .:. .vZQBQBBBRBQBQqiBQBQr.      rIqY:  Sq.XBBQDPI:  .ui  .r PQBBBQBBBQBQQ:                          
--                               .::.rPJqdgdEBQBQBZBPgBBQBQBRP:      rYUQBBBQB:Q:.:jr.     .dU   P  :siIBBBBQBQLB.                          
--                      .     .KSIBQMQJBgsiUBBQDBMQdDQBQBQQs.       :q    IBBgKii:JL       ig   2v :U5: .QBgB2gEBB.                         
--                   rBBQgI7riULiQK7MZ7BQS7BMBZQRBQBQBQZ:    :LdQBBQR  :77ri..   :d        75   E  s7I   i jIB.BIBD                         
--            7:IJu5BQB7iUgXIiJrgLsRrvBddMBBBQBQBQBPY.      Qi  vQBQBiuuY:.      P5       .vI   Z  i71  g   uQiZvQB                         
--       . ..QZdSiIBEP1rr1Mq.1vYYdq.rD52dP5BQ5YSir         P.  :7dji.:.          d7        7s   Q  YIJ .B   iB:ELBQ                         
--      rrJK1s7uJj571IQE vBviQ:UMvB.UQBBB2d.         .::7r:R2YqYZ                U7        iY   Dr .1iDPBQi.2B BYQB                         
--    .B sq::7.Yi5 ..IBBvvQgdb5PDggBQDbLiX     ..IRIrPPMbPqP:  j.                Su ::irr1Y:U    B  i17vMBQBB.2BqBP                         
--    QdJgv.:.rr17 5i7Q2B:sIDr7E.Ysru7r:    .jRRP:.idZr.  U   :K          i..:vr1SB:17I7KuugQL   .QiQ1i:ii:rvqBuBQ                          
--    QSgQqi::77YQ.L:Ug:.QSMggEXrIUr..  .L2QQB7: iqj     2.   v:   .::vviqQUJJ5uIvd5:vXPbgXv5B:   .IKXRP7EQBBBIZQQrEX                       
--    .rirKZKJB:KgErrLQBEPj1dPQPJ.:    U:  L5   Lq.      P    Ld7S7JjSP2qPEXUvri7JsKEQBb.E.s::B.    :2QBBQBQYiMQBQBQi                       
--   vr.j1Ud.rQuu5EBJJ25DB7:          QY.irU.JQ q:     ::s:YvPYQPduSrr727vs1KPEBQBQBQi7v : vBr:BX   .u:LgBEREBQBBBQB                        
--    iijDU  .X1BrU2PIRUi       . ..:.BUQ.B :gBiS...7rYsR7Z7MBjrIIgZgdQRQQBggqBQBQBQ:  1   :BQE BQv     7qZvbMBBRXBZr:                      
--        .     .i        .UQBQBZQurrBQ K Qi YQjQKZDEDEUQBQgvviBQBBQ7BQBBBQBQBQPJL:. UBBM1srBBQB LBBPu:i:77UQBuBBi:Qd                       
--                     :PQBQ.IP      YB E Ki:iBiKSBBBRBddvX: 71Qu7B LQMdBDQQBr:     YrX.vbBQjQBBB::QBQBQBQBQi rBBQ2iBQ.                     
--                 :SQQQL5i. r   .:ii uii:.UsSQBQM:  :       .QB EQ QB     UBr      B : rBQu5BQBBBX..  .BBQB .QBQBQd:Bq                     
--             .vvBsb7irq.  BvrYJv7:7..D   Pj QQBr  .J7qEDBdr rQ.L. s   iZr BQ      P.7  1BuBQBBBQBQK7  BBBQ  BBBQBQBDSv..LYi               
--          :uJriJrr:Y iQ  .dr..    .v Dr. :2 .L.JPBBBQPLgQBBBiUr:.i:rQY:BQ BB       BQ:  LBLXqKSXvIK ..1Li::dQBQBBQ.iJMB: :B               
--      v5J7Bqrq7Q25SQ7 B.  Prv:irir:i IBBBvi:i  .BQBg.iQBBZBMBgBIBQBQP: gv BQ     .ruZXs..                iBQBBBQB2  rvJis.BLriii.         
-- r7qdUQBYXP2QB qvr::  Q:  UK. .. .i7 r:gQ17S. :7BBQ riILrs::   .rBBBY  gd QB     .DdZbvgDBQ. rKBBUMQZBgb1QQi.v2  ..j7K:iv7:vrriPBE        
-- Ri7Y2 RS .:   u:     Q:  j:. .   .  ir7BPiQ.XY1r:. i:   7s .:   UuUi  QB:7B.     7vqv 1BQBQBBqLXQi    7i       .ri   EL        BQ        
-- Qr7ur:7r:7i.7:gR7sXBQ1BEPg:v2.:ZL.:I  B: ruB..  :        ...7. :BBBQ .Q   B      vL  :BBBQBQB:  P     gg ZYE   :i 1Q7  SPE7vv.:QU        
--:MQSBEgQuKZ7BQBqIS77BQK7vQB vIRYgBBB51grE. .7 B i:v         :r.i:vS.i.:.:r:Qi     ri.  gBBBQBB:  7     .Kii.:  i qBKd Y iQrPBQ.           
--budQiibU7777.ir7iqIqYbQ7iJX2 vJqM.Q7 RXSI: 1Q 7 :.5         gr     :75117s: YBb7v1J:ii.B 7QBBBQBBBQBBB     : i . BB d1L :i .BP            
--PSvZ55BJBRQiMbsI.v57vv:r2Ssqd5rUDiQ77BBBQQYBBZBE:...  r...  L r        :..: 5EBgBQRBgi j  YQQQBQBQBBBvQQ2..sB5Q2K.:i.qBQDQB:              
-- .  .775sK7gQZP12PusE2.L.QvrsPKviiru7XLLrLX2LdZQBdv. :.. .            .:   :Qv.BQBBQ.SQg5BBBQZQQQRDB  BBi  L2Qid:K L.::uBBQBQY            
--          1Kr:7vLDZ7PI1XuRY 7ivgX7sBrviiSbr...:.BKI:ru. . 7   .i   .. i:. rDBQ YQi   QBBBZMQP BZi:BQ  BQ.  Q QdiR.b:7.B7.UBQBQs           
--                 r vM7rrSErJvuSbIBYKPr:rbiY1Js.g7Prs2Y. ..7rr2i.::i::.r7:.iBQBq... vQBgBQBgQQ DB.Pr  7QBJ7rgs Qb7B.M2ui:d  BgB:           
--                   :.irIP.1Quqi7v5:XDP5 BvB7iQDBiBUZvQjSX1..  17Y.:vBdL:r:::.irirsdQqSBQBBBgBQ.r:   iQBQi7Lri  . .           Pv..         
--                     : iB.su.D:: K.M Yq.UiQJ.rrr.D.5rrQKbBQY:1jIQSrLvY   iv1YQDQbii:... .. .:v7..JJBQBQQ SuKXRdXqdgBDQZQUdDg5BSuJSIXIUrvJ:
--                        .  i :iP5 Bur7E:jiUbr7gXdiiri7di.gPjQvg1:SIQBQEXBQsPPIIL.   :r2rvPP7vv5PqXSi:::.SZQQBQBQBBBQBQBQBQBQBq5BBBBQBBBs  
--                                : . .i:D r.7:QYiS.ibIvBiYdrBURii7siKBrjb2B.SBZPUPdsRBjBEvBQQQs..   ri7vKv7.::.:i::.::i:vv1:L1dQBBgL:iqZ57 
--                                        i  7 : .B2:1bLsrr:Pj Z:X5:v i5udQ:.gBr7JIgBQ.v7XJIiDXU. J1KSBBM1BQqBBMD:777v5i:i:.i:ir7rr.        
--                                                 ...i Yu  Pii1gv2u7ZP:QUBiPBMXZ.PBY5KggSiSiJiBQBXrSrqB5X.LRPur.:.77EMBQBQBBBZKi:r:        
--                                                          :.     i: u.vi:LJi.r:7.i: :IS:SrB:J..Bi IQ.d:5UrBBr7BQBgB7jr2vB:2:              
--                                                                                                    .  v   :. . .                          
----New series of simple scripts that just work..nothing fancy 
-- Possible better EZ...who knows.... WTF R at times
if myHero.charName ~= "Ezreal" then return end
require "DamageLib"
keybindings = { [ITEM_1] = HK_ITEM_1, [ITEM_2] = HK_ITEM_2, [ITEM_3] = HK_ITEM_3, [ITEM_4] = HK_ITEM_4, [ITEM_5] = HK_ITEM_5, [ITEM_6] = HK_ITEM_6}
local castSpell = {state = 0, tick = GetTickCount(), casting = GetTickCount() - 1000, mouse = mousePos}
local barHeight = 8
local barWidth = 103
local barXOffset = 0
local barYOffset = 0
function SetMovement(bool)
	if _G.EOWLoaded then
		EOW:SetMovements(bool)
		EOW:SetAttacks(bool)
	elseif _G.SDK then
		_G.SDK.Orbwalker:SetMovement(bool)
		_G.SDK.Orbwalker:SetAttack(bool)
	else
		GOS.BlockMovement = not bool
		GOS.BlockAttack = not bool
	end
	if bool then
		castSpell.state = 0
	end
end

class "Ezreal"
local Scriptname,Version,Author,LVersion = "EzrealExpress","v1.0","Tocsin","7.17"

function CurrentTarget(range)
	if _G.SDK then
		return _G.SDK.TargetSelector:GetTarget(range, _G.SDK.DAMAGE_TYPE_PHYSICAL);
	elseif _G.EOW then
		return _G.EOW:GetTarget(range)
	else
		return _G.GOS:GetTarget(range,"AD")
	end
end

function Ezreal:__init()
	
	self:LoadSpells()
	self:LoadMenu()
	Callback.Add("Tick", function() self:Tick() end)
	Callback.Add("Draw", function() self:Draw() end)
	local orbwalkername = ""
	if _G.SDK then
		orbwalkername = "IC'S orbwalker"		
	elseif _G.EOW then
		orbwalkername = "EOW"	
	elseif _G.GOS then
		orbwalkername = "Noddy orbwalker"
	else
		orbwalkername = "Orbwalker not found"
	end
	PrintChat(Scriptname.." "..Version.." - Loaded...."..orbwalkername)
end

local sqrt = math.sqrt
local function GetDistanceSqr(p1, p2)
    local dx = p1.x - p2.x
    local dz = p1.z - p2.z
    return (dx * dx + dz * dz)
end
local function GetDistance(p1, p2)
    return sqrt(GetDistanceSqr(p1, p2))
end
local function GetDistance2D(p1,p2)
    return sqrt((p2.x - p1.x)*(p2.x - p1.x) + (p2.y - p1.y)*(p2.y - p1.y))
end
local function ClosestToMouse(p1, p2) 
	if GetDistance(mousePos, p1) > GetDistance(mousePos, p2) then return p2 else return p1 end
end

local function CircleCircleIntersection(c1, c2, r1, r2) 
	local D = GetDistance(c1, c2)
	if D > r1 + r2 or D <= math.abs(r1 - r2) then return nil end 
	local A = (r1 * r2 - r2 * r1 + D * D) / (2 * D) 
	local H = math.sqrt(r1 * r1 - A * A)
	local Direction = (c2 - c1):Normalized() 
	local PA = c1 + A * Direction 
	local S1 = PA + H * Direction:Perpendicular() 
	local S2 = PA - H * Direction:Perpendicular() 
	return S1, S2 
end

function Ezreal:LoadSpells()

	Q = {Range = 1100, width = 60, Delay = 0.25, Speed = 1200, Collision = true, aoe = false, type = "linear"}
	W = {Range = 900, width = 80, Delay = 0.25, Speed = 1200, Collision = false, aoe = false, type = "linear"}
	E = {Range = 450, Delay = 0.25}
	R = {Range = 20000, width = 160, Delay = 1.00, Speed = 2000, Collision = false, aoe = false, type = "linear"}

end

function Ezreal:LoadMenu()
	self.Menu = MenuElement({type = MENU, id = "EzrealExpress", name = Scriptname})
	self.Menu:MenuElement({id = "ComboMode", name = "Combo", type = MENU})
	self.Menu.ComboMode:MenuElement({id = "UseQ", name = "Q: Mystic Shot", value = true})
	self.Menu.ComboMode:MenuElement({id = "UseW", name = "W: Essence Flux", value = true})
	self.Menu.ComboMode:MenuElement({id = "UseE", name = "E: Arcane Shift", value = true})
	self.Menu.ComboMode:MenuElement({id = "UseR", name = "R: Trueshot Barrage", value = true})
	self.Menu.ComboMode:MenuElement({id = "comboActive", name = "Combo key", key = string.byte(" ")})
	self.Menu.ComboMode:MenuElement({id = "DrawDamage", name = "Draw damage on HPbar", value = true})
		
	self.Menu:MenuElement({id = "HarassMode", name = "Harass", type = MENU})
	self.Menu.HarassMode:MenuElement({id = "UseQ", name = "Q: Mystic Shot", value = true})
	self.Menu.HarassMode:MenuElement({id = "harassActive", name = "Harass key", key = string.byte("C")})

	self.Menu:MenuElement({id = "ClearMode", name = "Clear", type = MENU})
	self.Menu.ClearMode:MenuElement({id = "UseQ", name = "Q: Mystic Shot", value = true})
	self.Menu.ClearMode:MenuElement({id = "UseE", name = "E: Arcane Shift", value = true})
	self.Menu.ClearMode:MenuElement({id = "UseR", name = "R: Trueshot Barrage", value = true})
	self.Menu.ClearMode:MenuElement({id = "clearActive", name = "Clear key", key = string.byte("V")})

	self.Menu:MenuElement({id = "CustomSpellCast", name = "Use custom spellcast", tooltip = "Can fix some casting problems with wrong directions and so", value = true})
	self.Menu:MenuElement({id = "delay", name = "Custom spellcast delay", value = 100, min = 0, max = 200, step = 5,tooltip = "increase this one if spells is going completely wrong direction", identifier = ""})
	
	self.Menu:MenuElement({id = "blank", type = SPACE , name = ""})
	self.Menu:MenuElement({id = "blank", type = SPACE , name = "Script Ver: "..Version.. " - LoL Ver: "..LVersion.. ""})
	self.Menu:MenuElement({id = "blank", type = SPACE , name = "by "..Author.. ""})
end

function GetInventorySlotItem(itemID)
		assert(type(itemID) == "number", "GetInventorySlotItem: wrong argument types (<number> expected)")
		for _, j in pairs({ ITEM_1, ITEM_2, ITEM_3, ITEM_4, ITEM_5, ITEM_6}) do
			if myHero:GetItemData(j).itemID == itemID and myHero:GetSpellData(j).currentCd == 0 then return j end
		end
		return nil
	    end

    function UseBotrk()
		local BTarget = CurrentTarget(500)
		if BTarget then 
			local botrkitem = GetInventorySlotItem(3153) or GetInventorySlotItem(3144)
			if botrkitem then
				Control.CastSpell(keybindings[botrkitem],BTarget.pos)
			end
		end
	end

function IsRecalling()
	for K, Buff in pairs(GetBuffs(myHero)) do
		if Buff.name == "recall" and Buff.duration > 0 then
			return true
		end
	end
	return false
end

function ValidTarget(target, range)
	range = range and range or math.huge
	return target ~= nil and target.valid and target.visible and not target.dead and target.distance <= range
end

function Ezreal:Tick()
    if myHero.dead or Game.IsChatOpen() == true or IsRecalling() == true then return end
	if self.Menu.HarassMode.harassActive:Value() and self:EnemyInRange(1200) then
		self:Harass()
	end
	if self.Menu.ComboMode.comboActive:Value() and self:EnemyInRange(2000) then
		self:Combo()
	end
	if self.Menu.ClearMode.clearActive:Value() then
		self:Jungle()
	end

end

function Ezreal:HasBuff(unit, buffname)
	for i = 0, unit.buffCount do
		local buff = unit:GetBuff(i)
		if buff.name == buffname and buff.count > 0 then 
			return true
		end
	end
	return false
end

function Ezreal:IsReady(spell)
	return Game.CanUseSpell(spell) == 0
end

function Ezreal:CheckMana(spellSlot)
	return myHero:GetSpellData(spellSlot).mana < myHero.mana
end

function Ezreal:CanCast(spellSlot)
	return self:IsReady(spellSlot) and self:CheckMana(spellSlot)
end

function EnableMovement()
	SetMovement(true)
end

function ReturnCursor(pos)
	Control.SetCursorPos(pos)
	DelayAction(EnableMovement,0.1)
end

function LeftClick(pos)
	Control.mouse_event(MOUSEEVENTF_LEFTDOWN)
	Control.mouse_event(MOUSEEVENTF_LEFTUP)
	DelayAction(ReturnCursor,0.05,{pos})
end
function Ezreal:Draw()
    if self:CanCast(_Q) then Draw.Circle(myHero.pos, 1100, 3,  Draw.Color(255, 000, 222, 255)) end
	if self.Menu.ComboMode.DrawDamage:Value() then
		for i, hero in pairs(self:GetEnemyHeroes()) do
			local barPos = hero.hpBar
			if not hero.dead and hero.pos2D.onScreen and barPos.onScreen and hero.visible then
				local QDamage = (self:CanCast(_Q) and getdmg("Q",hero,myHero) or 0)
				local WDamage = (self:CanCast(_W) and getdmg("W",hero,myHero) or 0)
				local EDamage = (self:CanCast(_E) and getdmg("E",hero,myHero) or 0)
				local RDamage = (self:CanCast(_R) and getdmg("R",hero,myHero) or 0)
				local damage = QDamage + WDamage + EDamage + RDamage
				if damage > hero.health then
					Draw.Text("killable", 24, hero.pos2D.x, hero.pos2D.y,Draw.Color(0xFF00FF00))
					
				else
					local percentHealthAfterDamage = math.max(0, hero.health - damage) / hero.maxHealth
					local xPosEnd = barPos.x + barXOffset + barWidth * hero.health/hero.maxHealth
					local xPosStart = barPos.x + barXOffset + percentHealthAfterDamage * 100
					Draw.Line(xPosStart, barPos.y + barYOffset, xPosEnd, barPos.y + barYOffset, 10, Draw.Color(0xFF00FF00))
				end
			end
		end	
	end
end

function Ezreal:CastSpell(spell,pos)
	local customcast = self.Menu.CustomSpellCast:Value()
	if not customcast then
		Control.CastSpell(spell, pos)
		return
	else
		local delay = self.Menu.delay:Value()
		local ticker = GetTickCount()
		if castSpell.state == 0 and ticker > castSpell.casting then
			castSpell.state = 1
			castSpell.mouse = mousePos
			castSpell.tick = ticker
			if ticker - castSpell.tick < Game.Latency() then
				SetMovement(false)
				Control.SetCursorPos(pos)
				Control.KeyDown(spell)
				Control.KeyUp(spell)
				DelayAction(LeftClick,delay/1000,{castSpell.mouse})
				castSpell.casting = ticker + 500
			end
		end
	end
end

function Ezreal:Combo()
	if self:CanCast(_Q) and self:EnemyInRange(1050) then 
		local QTarget = CurrentTarget(1050)
		if self.Menu.ComboMode.UseQ:Value() and QTarget then
			if self:EnemyInRange(1100) and myHero.pos:DistanceTo(QTarget.pos) < 1050 and QTarget:GetCollision(60, 1200, 0.25) == 0 then
				castPos = QTarget:GetPrediction(1200, 0.25)
				local newpos = myHero.pos:Extended(castPos,math.random(100,300))
				self:CastSpell(HK_Q, newpos)
			end
		end
	end

	if self:CanCast(_W) and self:EnemyInRange(880) then 
		local WTarget = CurrentTarget(880)
		if self.Menu.ComboMode.UseW:Value() and WTarget then
			if self:EnemyInRange(880) and myHero.pos:DistanceTo(WTarget.pos) < 880 then
				castPos = WTarget:GetPrediction(1200, 0.25)
				local newpos = myHero.pos:Extended(castPos,math.random(100,300))
				self:CastSpell(HK_W, castPos)
			end
		end
	end

    if self:EnemyInRange(500) and not self:CanCast(_Q) then 
        local BTarget = CurrentTarget(500)
        if BTarget then
            if myHero.pos:DistanceTo(BTarget.pos) < 500 then
			    UseBotrk()
            end
        end
    end

    if self:CanCast(_E) and self:EnemyInRange(1500) then
        local ETarget = CurrentTarget(1500) 
		if self.Menu.ComboMode.UseE:Value() and ETarget then
			if myHero.pos:DistanceTo(ETarget.pos) > 850 and self:CanCast(_Q) then
				Control.CastSpell(HK_E, ETarget)
			else
				local c1, c2, r1, r2 = Vector(myHero.pos), Vector(ETarget.pos), myHero.range, 525 
				local O1, O2 = CircleCircleIntersection(c1, c2, r1, r2) 
				if O1 or O2 then
					local pos = c1:Extended(Vector(ClosestToMouse(O1, O2)), 425)
					Control.CastSpell(HK_E, pos) 
				end
			end
		end
	end

    if self:CanCast(_R) and self:EnemyInRange(2000) then 
		local RTarget = CurrentTarget(2000)
		if self.Menu.ComboMode.UseR:Value() and RTarget then
			local RDamage = (self:CanCast(_R) and getdmg("R",RTarget,myHero) or 0)
			if RDamage > RTarget.health and myHero.pos:DistanceTo(RTarget.pos) > 650 then
				castPos = RTarget:GetPrediction(2000, 1.00)
				local newpos = myHero.pos:Extended(castPos,math.random(100,300))
				self:CastSpell(HK_R, newpos)
			end
		end
	end
end

function Ezreal:GetEnemyHeroes()
	self.EnemyHeroes = {}
	for i = 1, Game.HeroCount() do
		local Hero = Game.Hero(i)
		if Hero.isEnemy then
			table.insert(self.EnemyHeroes, Hero)
		end
	end
	return self.EnemyHeroes
end

function Ezreal:EnemyInRange(range)
	local count = 0
	for i, target in ipairs(self:GetEnemyHeroes()) do
		if target.pos:DistanceTo(myHero.pos) < range then 
			count = count + 1
		end
	end
	return count
end

function Ezreal:Harass()
    if self:CanCast(_Q) and self:EnemyInRange(1100) then 
		local QTarget = CurrentTarget(1100)
		if self.Menu.HarassMode.UseQ:Value() and QTarget and QTarget:GetCollision(70, 1200, 0.25) == 0 then
			if self:EnemyInRange(1100) and myHero.pos:DistanceTo(QTarget.pos) > 550 then
				castPos = QTarget:GetPrediction(1100, 0.25)
				local newpos = myHero.pos:Extended(castPos,math.random(100,300))
			    self:CastSpell(HK_Q, newpos)
            end
		end
	end
	
end

function Ezreal:Jungle()
	for i = 1, Game.MinionCount() do
	local minion = Game.Minion(i)
	if minion and minion.team == 300 or minion.team ~= myHero.team then
		if self:CanCast(_Q) then 
			if self.Menu.ClearMode.UseQ:Value() and minion then
				if ValidTarget(minion, 1100) and myHero.pos:DistanceTo(minion.pos) < 1100 then
					Control.CastSpell(HK_Q, minion)
				end
			end
		end

    	if self:CanCast(_E) then 
			if self.Menu.ClearMode.UseE:Value() and minion then
				if ValidTarget(minion, 650) then
					Control.CastSpell(HK_E)
				end
			end
		end

	end
	end
end

function OnLoad()
	Ezreal()
end